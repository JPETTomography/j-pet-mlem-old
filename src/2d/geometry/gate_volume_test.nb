(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12281,        393]
NotebookOptionsPosition[     10990,        342]
NotebookOutlinePosition[     11348,        358]
CellTagsIndexPosition[     11305,        355]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"da", "=", " ", 
  RowBox[{
   RowBox[{"1", "/", "2"}], " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.05", ",", " ", "0.1"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0.05", ",", 
       RowBox[{"-", "0.1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.05"}], ",", " ", 
       RowBox[{"-", "0.1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.05"}], ",", "0.1"}], "}"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.708318616458009*^9, 3.708318697032123*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.025`", ",", "0.05`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.025`", ",", 
     RowBox[{"-", "0.05`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.025`"}], ",", 
     RowBox[{"-", "0.05`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.025`"}], ",", "0.05`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.708318697464223*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Polygon", "[", "%", "]"}], "//", "Graphics"}]], "Input",
 CellChangeTimes->{{3.708318701077518*^9, 3.70831870834199*^9}}],

Cell[BoxData[
 GraphicsBox[
  PolygonBox[{{0.025, 0.05}, {0.025, -0.05}, {-0.025, -0.05}, {-0.025, 
   0.05}}]]], "Output",
 CellChangeTimes->{3.7083187089337254`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dat", "=", 
  RowBox[{
   RowBox[{"Composition", "[", 
    RowBox[{
     RowBox[{"TranslationTransform", "[", 
      RowBox[{"{", 
       RowBox[{"0.15", ",", "0"}], "}"}], "]"}], ",", 
     RowBox[{"RotationTransform", "[", " ", 
      RowBox[{"Pi", "/", "4"}], "]"}], ",", 
     RowBox[{"TranslationTransform", "[", 
      RowBox[{"{", 
       RowBox[{"0.05", ",", "0"}], "}"}], "]"}]}], "]"}], "[", "da", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7083187824319468`*^9, 3.70831889896742*^9}, {
  3.708318951992258*^9, 3.70831896776409*^9}, {3.708319014848455*^9, 
  3.708319016063107*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1676776695296637`", ",", "0.08838834764831843`"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"0.23838834764831845`", ",", "0.017677669529663688`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.20303300858899107`", ",", 
     RowBox[{"-", "0.017677669529663688`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1323223304703363`", ",", "0.053033008588991064`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.708318811100963*^9, 3.708318899562104*^9}, 
   3.708318968495945*^9, 3.708319016875305*^9, 3.708319868072974*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dbt", "=", 
  RowBox[{
   RowBox[{"Composition", "[", 
    RowBox[{
     RowBox[{"TranslationTransform", "[", 
      RowBox[{"{", 
       RowBox[{"0.15", ",", "0"}], "}"}], "]"}], ",", 
     RowBox[{"RotationTransform", "[", " ", 
      RowBox[{"Pi", "/", "4"}], "]"}], ",", 
     RowBox[{"TranslationTransform", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.05"}], ",", "0"}], "}"}], "]"}]}], "]"}], "[", "da", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7083190242231827`*^9, 3.7083190280899553`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.09696699141100892`", ",", "0.017677669529663688`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.16767766952966368`", ",", 
     RowBox[{"-", "0.053033008588991064`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1323223304703363`", ",", 
     RowBox[{"-", "0.08838834764831843`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.061611652351681555`", ",", 
     RowBox[{"-", "0.017677669529663688`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.708319028486032*^9, 3.7083198724749403`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.708319059520462*^9, 3.708319083700898*^9}}],

Cell[BoxData["\<\"/Users/pbialas/PET/tools/src/2d/geometry\"\>"], "Output",
 CellChangeTimes->{3.708319084130138*^9, 3.708319873914597*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<gate_volume_test.txt\>\"", ",", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"dat", ",", " ", "dbt"}], "]"}], ",", " ", "\"\<Table\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7083190318797398`*^9, 3.7083190537636766`*^9}, {
  3.708319088211666*^9, 3.708319122503271*^9}}],

Cell[BoxData["\<\"gate_volume_test.txt\"\>"], "Output",
 CellChangeTimes->{3.7083190492384567`*^9, 3.708319124193165*^9, 
  3.708319875107716*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinearRepeat", "[", 
   RowBox[{"poly_", ",", " ", "tr_", ",", " ", "n_", ",", " ", "v_"}], "]"}], 
  ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"last", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], " ", "v"}]}], ",", " ", "t"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"t", " ", "=", " ", 
      RowBox[{"Composition", "[", 
       RowBox[{"tr", ",", 
        RowBox[{"TranslationTransform", "[", 
         RowBox[{
          RowBox[{"-", "last"}], "/", "2"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"t", "/@", 
        RowBox[{
         RowBox[{"TranslationTransform", "[", "#", "]"}], "[", "poly", 
         "]"}]}], "&"}], "/@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"v", "*", "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.708321747644915*^9, 3.7083217976110697`*^9}, {
  3.708321850263529*^9, 3.708322109868647*^9}, {3.708322187565549*^9, 
  3.708322187789625*^9}, {3.708322220978774*^9, 3.708322297077015*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pr", "=", 
  RowBox[{"LinearRepeat", "[", 
   RowBox[{"da", ",", 
    RowBox[{"TranslationTransform", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", "4", " ", ",", " ", 
    RowBox[{"{", 
     RowBox[{"0.1", ",", " ", "0.0"}], "}"}]}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.708322113554571*^9, 3.7083221766513033`*^9}, {
  3.708322309351143*^9, 3.708322339446484*^9}, {3.708322375336426*^9, 
  3.708322423734576*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.12500000000000003`"}], ",", "0.05`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.12500000000000003`"}], ",", 
       RowBox[{"-", "0.05`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.17500000000000002`"}], ",", 
       RowBox[{"-", "0.05`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.17500000000000002`"}], ",", "0.05`"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.025000000000000022`"}], ",", "0.05`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.025000000000000022`"}], ",", 
       RowBox[{"-", "0.05`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.07500000000000001`"}], ",", 
       RowBox[{"-", "0.05`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.07500000000000001`"}], ",", "0.05`"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.07499999999999998`", ",", "0.05`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.07499999999999998`", ",", 
       RowBox[{"-", "0.05`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.024999999999999994`", ",", 
       RowBox[{"-", "0.05`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.024999999999999994`", ",", "0.05`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.17500000000000004`", ",", "0.05`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.17500000000000004`", ",", 
       RowBox[{"-", "0.05`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.125`", ",", 
       RowBox[{"-", "0.05`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.125`", ",", "0.05`"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.708322165604187*^9, 3.708322189510737*^9}, 
   3.7083222272398367`*^9, {3.708322260002327*^9, 3.708322340311317*^9}, {
   3.70832237709464*^9, 3.708322399238227*^9}, 3.7083224312277327`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.708322097161268*^9, 3.708322111387178*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"Polygon", "/@", "pr"}], ",", " ", 
   RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7083223423676367`*^9, 3.7083223823782177`*^9}, {
  3.708322427897513*^9, 3.7083224281338263`*^9}}],

Cell[BoxData[
 GraphicsBox[{
   PolygonBox[{{-0.12500000000000003`, 
    0.05}, {-0.12500000000000003`, -0.05}, {-0.17500000000000002`, -0.05}, \
{-0.17500000000000002`, 0.05}}], 
   PolygonBox[{{-0.025000000000000022`, 
    0.05}, {-0.025000000000000022`, -0.05}, {-0.07500000000000001, -0.05}, \
{-0.07500000000000001, 0.05}}], 
   PolygonBox[{{0.07499999999999998, 0.05}, {0.07499999999999998, -0.05}, {
    0.024999999999999994`, -0.05}, {0.024999999999999994`, 0.05}}], 
   PolygonBox[{{0.17500000000000004`, 0.05}, {0.17500000000000004`, -0.05}, {
    0.125, -0.05}, {0.125, 0.05}}]},
  Frame->True]], "Output",
 CellChangeTimes->{{3.7083223582069693`*^9, 3.7083224329196997`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<gate_volume_s_repeater_test.txt\>\"", ",", 
   RowBox[{"Flatten", "[", 
    RowBox[{"pr", ",", "1"}], "]"}], ",", "\"\<Table\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.708322436583705*^9, 3.708322484701893*^9}, {
  3.708322753444085*^9, 3.7083227562560577`*^9}, {3.7083231935171423`*^9, 
  3.7083231947084417`*^9}}],

Cell[BoxData["\<\"gata_volume_s_repeater_test.txt\"\>"], "Output",
 CellChangeTimes->{{3.708322444255596*^9, 3.7083224473341227`*^9}, 
   3.708322485211852*^9, 3.708322758444512*^9, 3.708323175337762*^9}]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{Automatic, -1152}, {150, Automatic}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 28, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 576, 18, 32, "Input"],
Cell[1159, 42, 451, 15, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1647, 62, 156, 3, 32, "Input"],
Cell[1806, 67, 167, 4, 447, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2010, 76, 618, 16, 54, "Input"],
Cell[2631, 94, 610, 16, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3278, 115, 548, 15, 54, "Input"],
Cell[3829, 132, 577, 15, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4443, 152, 170, 3, 32, "Input"],
Cell[4616, 157, 139, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4792, 163, 329, 7, 32, "Input"],
Cell[5124, 172, 146, 2, 32, "Output"]
}, Open  ]],
Cell[5285, 177, 1316, 37, 96, "Input"],
Cell[CellGroupData[{
Cell[6626, 218, 477, 11, 32, "Input"],
Cell[7106, 231, 2150, 63, 96, "Output"]
}, Open  ]],
Cell[9271, 297, 92, 1, 32, "Input"],
Cell[CellGroupData[{
Cell[9388, 302, 279, 6, 32, "Input"],
Cell[9670, 310, 687, 13, 136, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10394, 328, 373, 7, 32, "Input"],
Cell[10770, 337, 204, 2, 32, "Output"]
}, Open  ]]
}
]
*)

