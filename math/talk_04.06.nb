(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     34851,        978]
NotebookOptionsPosition[     34015,        950]
NotebookOutlinePosition[     34352,        965]
CellTagsIndexPosition[     34309,        962]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"LabeledArrow", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"begin_", ",", "end_"}], "}"}], ",", "text_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Arrowheads", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", ".025"}], ",", ".025"}], "}"}], "]"}], ",", 
    RowBox[{"Arrow", "[", 
     RowBox[{"{", 
      RowBox[{"begin", ",", "end"}], "}"}], "]"}], ",", 
    RowBox[{"Text", "[", 
     RowBox[{"text", ",", 
      RowBox[{
       RowBox[{"1", "/", "2"}], 
       RowBox[{"(", 
        RowBox[{"begin", "+", "end"}], ")"}]}], ",", 
      RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], "}"}]}]], "Input",\

 CellChangeTimes->{{3.579147553155565*^9, 3.57914755517473*^9}, 
   3.579147592810015*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drawDetector", "[", 
   RowBox[{"{", 
    RowBox[{"R_", ",", "L_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "L"}], "/", "2"}], ",", "R"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"L", "/", "2"}], ",", "R"}], "}"}]}], "}"}], "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "L"}], "/", "2"}], ",", 
           RowBox[{"-", "R"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"L", "/", "2"}], ",", 
           RowBox[{"-", "R"}]}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.579147607808497*^9, 3.579147716718827*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"draw2DAxes", "[", 
   RowBox[{"c_", ",", 
    RowBox[{"{", 
     RowBox[{"a1_", ",", "l1_", ",", "t1_", ",", 
      RowBox[{"s1_", " ", ":", " ", "0.1"}]}], " ", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a2_", ",", "l2_", ",", "t2_", ",", " ", 
      RowBox[{"s2_", " ", ":", " ", "0.1"}]}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Thickness", "[", "0.001", "]"}], ",", " ", 
      RowBox[{"Dashing", "[", "0.01", "]"}], ",", " ", 
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"c", "-", 
          RowBox[{"s1", "  ", "l1", " ", "a1"}]}], ",", 
         RowBox[{"c", "+", 
          RowBox[{"a1", " ", "l1"}]}]}], "}"}], "]"}], ",", " ", 
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"c", "-", 
          RowBox[{"s2", "  ", "l2", " ", "a2"}]}], ",", 
         RowBox[{"c", "+", 
          RowBox[{"a2", " ", "l2"}]}]}], "}"}], "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.579147796066277*^9, 3.5791478017894*^9}, {
  3.579147841346339*^9, 3.579147879145787*^9}, {3.579147934112458*^9, 
  3.579147986912305*^9}, {3.579148118723959*^9, 3.579148124248703*^9}, {
  3.579148159407291*^9, 3.579148265191451*^9}, {3.579148357760255*^9, 
  3.579148397116788*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drawEvent", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"y_", ",", "z_", ",", "\[Theta]_"}], "}"}], ",", "R_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"zu", ",", "zd", ",", "dl", ",", "m"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zu", ",", "zd", ",", "dl"}], "}"}], "=", " ", 
      RowBox[{"toProjectionSpaceTheta", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"y", ",", "z", ",", "\[Theta]"}], "}"}], ",", "R"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"zu", ",", "R"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"zd", ",", 
            RowBox[{"-", "R"}]}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"Red", ",", 
         RowBox[{"PointSize", "[", "0.025", "]"}], ",", 
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"z", ",", "y"}], "}"}], "]"}]}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.579148499344023*^9, 3.579148693251192*^9}, {
  3.57914875489767*^9, 3.579148793853823*^9}}],

Cell[BoxData[
 RowBox[{"trueEvent", "=", 
  RowBox[{"{", 
   RowBox[{"100", ",", "40", ",", 
    RowBox[{
     RowBox[{"-", "15"}], " ", "Degree"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.579186238594528*^9, 3.579186253310195*^9}}],

Cell[BoxData[
 RowBox[{"detector", "=", " ", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"event", "=", "trueEvent"}], ",", 
       RowBox[{"R", "=", "450"}], ",", 
       RowBox[{"L", "=", "500"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"drawDetector", "[", 
        RowBox[{"{", 
         RowBox[{"R", ",", "L"}], "}"}], "]"}], ",", " ", 
       RowBox[{"draw2DAxes", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{
            RowBox[{"L", "/", "2"}], "+", "50"}], ",", "\"\<z\>\"", ",", 
           "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"R", "+", "50"}], ",", "\"\<y\>\"", ",", "1"}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"drawEvent", "[", 
        RowBox[{"event", ",", "R"}], "]"}]}], "}"}]}], "]"}], "//", 
   "Graphics"}]}]], "Input",
 CellChangeTimes->{{3.579147691646622*^9, 3.579147709546602*^9}, {
  3.579147990514357*^9, 3.579148096186045*^9}, {3.579148190766254*^9, 
  3.579148190991896*^9}, {3.579148274227846*^9, 3.579148304098861*^9}, {
  3.579148697041789*^9, 3.579148735914361*^9}, {3.57914882508869*^9, 
  3.579148827720453*^9}, {3.579184965227661*^9, 3.57918505793322*^9}, {
  3.579185823804418*^9, 3.579185828700065*^9}, {3.579186258190462*^9, 
  3.579186266578753*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"event", "=", 
        RowBox[{"{", 
         RowBox[{"100", ",", "40", ",", 
          RowBox[{
           RowBox[{"-", "15"}], " ", "Degree"}]}], "}"}]}], ",", 
       RowBox[{"R", "=", "450"}], ",", 
       RowBox[{"L", "=", "500"}], ",", "zu", ",", "zd", ",", "dl", ",", 
       RowBox[{"e", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"zu", ",", "zd", ",", "dl"}], "}"}], "=", 
       RowBox[{"toProjectionSpaceTheta", "[", 
        RowBox[{"event", ",", "R"}], "]"}]}], ";", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"drawDetector", "[", 
         RowBox[{"{", 
          RowBox[{"R", ",", "L"}], "}"}], "]"}], ",", " ", 
        RowBox[{"draw2DAxes", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{
             RowBox[{"L", "/", "2"}], "+", "50"}], ",", "\"\<z\>\"", ",", 
            "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"R", "+", "50"}], ",", "\"\<y\>\"", ",", "1"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"drawEvent", "[", 
         RowBox[{"event", ",", "R"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"zu", ",", "R"}], "}"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.025"}], ",", "0"}], "}"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "L"}], "/", "2"}], ",", 
               RowBox[{"R", "+", "e"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"zu", ",", 
               RowBox[{"R", "+", "e"}]}], "}"}]}], "}"}], "]"}]}], "}"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.025"}], "}"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zu", ",", 
               RowBox[{"R", "+", "e"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"L", "/", "2"}], ",", 
               RowBox[{"R", "+", "e"}]}], "}"}]}], "}"}], "]"}]}], "}"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"zd", ",", 
             RowBox[{"-", "R"}]}], "}"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.025"}], ",", "0"}], "}"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "L"}], "/", "2"}], ",", 
               RowBox[{
                RowBox[{"-", "R"}], "-", "e"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"zd", ",", 
               RowBox[{
                RowBox[{"-", "R"}], "-", "e"}]}], "}"}]}], "}"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.025"}], "}"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zd", ",", 
               RowBox[{
                RowBox[{"-", "R"}], "-", "e"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"L", "/", "2"}], ",", 
               RowBox[{
                RowBox[{"-", "R"}], "-", "e"}]}], "}"}]}], "}"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(z\), \(u\)]\)\>\"", ",", "Medium"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"zu", ",", "R"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(z\), \(d\)]\)\>\"", ",", "Medium"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"zd", ",", 
            RowBox[{"-", "R"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
       "}"}]}]}], "]"}], "//", "Graphics"}]}]], "Input",
 CellChangeTimes->{{3.579147691646622*^9, 3.579147709546602*^9}, {
  3.579147990514357*^9, 3.579148096186045*^9}, {3.579148190766254*^9, 
  3.579148190991896*^9}, {3.579148274227846*^9, 3.579148304098861*^9}, {
  3.579148697041789*^9, 3.579148735914361*^9}, {3.57914882508869*^9, 
  3.579148827720453*^9}, {3.579184965227661*^9, 3.579185121449419*^9}, {
  3.579185163825814*^9, 3.579185422735683*^9}, {3.579185453475332*^9, 
  3.579185591745251*^9}, {3.579185628085356*^9, 3.57918566988596*^9}, {
  3.57918574319376*^9, 3.579185760518985*^9}, {3.579185800405533*^9, 
  3.579185814710694*^9}, {3.579185905916575*^9, 3.579186043971324*^9}}],

Cell[BoxData[
 RowBox[{"R", "=", "450"}]], "Input",
 CellChangeTimes->{{3.579186329091785*^9, 3.579186330101155*^9}}],

Cell[BoxData[
 RowBox[{"c", "=", 
  RowBox[{
   RowBox[{"correlationMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"30", ",", "90", ",", "10"}], "}"}], "]"}], "//", 
   "N"}]}]], "Input",
 CellChangeTimes->{{3.579186126524217*^9, 3.579186138640509*^9}, {
  3.579186183533258*^9, 3.579186197840115*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"900", ",", "0", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "900", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "10", ",", "8100"}], "}"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.579186174704119*^9, 3.579186176296474*^9}}],

Cell[BoxData[
 RowBox[{"diff", "=", 
  RowBox[{
   RowBox[{"gauss", "[", 
    RowBox[{"c", ",", "1"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.579186178483634*^9, 3.579186190739401*^9}, {
  3.579186277967304*^9, 3.5791862801448*^9}, {3.579186351523265*^9, 
  3.579186352120802*^9}}],

Cell[BoxData[
 RowBox[{"reconEvent", "=", 
  RowBox[{"fromProjectionSpaceTheta", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"toProjectionSpaceTheta", "[", 
      RowBox[{"trueEvent", ",", "R"}], "]"}], "+", "diff"}], ",", "R"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.579186283858267*^9, 3.579186344750448*^9}, {
  3.579186381316264*^9, 3.579186392989856*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"event", "=", 
        RowBox[{"{", 
         RowBox[{"100", ",", "40", ",", 
          RowBox[{
           RowBox[{"-", "15"}], " ", "Degree"}]}], "}"}]}], ",", 
       RowBox[{"R", "=", "450"}], ",", 
       RowBox[{"L", "=", "500"}], ",", "zu", ",", "zd", ",", "dl", ",", 
       RowBox[{"e", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"zu", ",", "zd", ",", "dl"}], "}"}], "=", 
       RowBox[{"toProjectionSpaceTheta", "[", 
        RowBox[{"event", ",", "R"}], "]"}]}], ";", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"drawDetector", "[", 
         RowBox[{"{", 
          RowBox[{"R", ",", "L"}], "}"}], "]"}], ",", " ", 
        RowBox[{"draw2DAxes", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{
             RowBox[{"L", "/", "2"}], "+", "50"}], ",", "\"\<z\>\"", ",", 
            "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"R", "+", "50"}], ",", "\"\<y\>\"", ",", "1"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"drawEvent", "[", 
         RowBox[{"event", ",", "R"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"drawEvent", "[", 
         RowBox[{"reconEvent", ",", "R"}], "]"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"zu", ",", "R"}], "}"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.025"}], ",", "0"}], "}"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "L"}], "/", "2"}], ",", 
               RowBox[{"R", "+", "e"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"zu", ",", 
               RowBox[{"R", "+", "e"}]}], "}"}]}], "}"}], "]"}]}], "}"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.025"}], "}"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zu", ",", 
               RowBox[{"R", "+", "e"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"L", "/", "2"}], ",", 
               RowBox[{"R", "+", "e"}]}], "}"}]}], "}"}], "]"}]}], "}"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"zd", ",", 
             RowBox[{"-", "R"}]}], "}"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.025"}], ",", "0"}], "}"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "L"}], "/", "2"}], ",", 
               RowBox[{
                RowBox[{"-", "R"}], "-", "e"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"zd", ",", 
               RowBox[{
                RowBox[{"-", "R"}], "-", "e"}]}], "}"}]}], "}"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.025"}], "}"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zd", ",", 
               RowBox[{
                RowBox[{"-", "R"}], "-", "e"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"L", "/", "2"}], ",", 
               RowBox[{
                RowBox[{"-", "R"}], "-", "e"}]}], "}"}]}], "}"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(z\), \(u\)]\)\>\"", ",", "Medium"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"zu", ",", "R"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(z\), \(d\)]\)\>\"", ",", "Medium"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"zd", ",", 
            RowBox[{"-", "R"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
       "}"}]}]}], "]"}], "//", "Graphics"}]}]], "Input",
 CellChangeTimes->{{3.579147691646622*^9, 3.579147709546602*^9}, {
  3.579147990514357*^9, 3.579148096186045*^9}, {3.579148190766254*^9, 
  3.579148190991896*^9}, {3.579148274227846*^9, 3.579148304098861*^9}, {
  3.579148697041789*^9, 3.579148735914361*^9}, {3.57914882508869*^9, 
  3.579148827720453*^9}, {3.579184965227661*^9, 3.579185121449419*^9}, {
  3.579185163825814*^9, 3.579185422735683*^9}, {3.579185453475332*^9, 
  3.579185591745251*^9}, {3.579185628085356*^9, 3.57918566988596*^9}, {
  3.57918574319376*^9, 3.579185760518985*^9}, {3.579185800405533*^9, 
  3.579185814710694*^9}, {3.579185905916575*^9, 3.579186043971324*^9}, {
  3.57918641142518*^9, 3.579186439883657*^9}}],

Cell[BoxData[
 RowBox[{"rEvents", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"fromProjectionSpaceTheta", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"toProjectionSpaceTheta", "[", 
        RowBox[{"trueEvent", ",", "R"}], "]"}], "+", "#"}], ",", "R"}], "]"}],
     "&"}], "/@", 
   RowBox[{"gauss", "[", 
    RowBox[{"c", ",", "8"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.579186498160724*^9, 3.579186600445463*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"event", "=", 
        RowBox[{"{", 
         RowBox[{"100", ",", "40", ",", 
          RowBox[{
           RowBox[{"-", "15"}], " ", "Degree"}]}], "}"}]}], ",", 
       RowBox[{"R", "=", "450"}], ",", 
       RowBox[{"L", "=", "500"}], ",", "zu", ",", "zd", ",", "dl", ",", 
       RowBox[{"e", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"zu", ",", "zd", ",", "dl"}], "}"}], "=", 
       RowBox[{"toProjectionSpaceTheta", "[", 
        RowBox[{"event", ",", "R"}], "]"}]}], ";", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"drawDetector", "[", 
         RowBox[{"{", 
          RowBox[{"R", ",", "L"}], "}"}], "]"}], ",", " ", 
        RowBox[{"draw2DAxes", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{
             RowBox[{"L", "/", "2"}], "+", "50"}], ",", "\"\<z\>\"", ",", 
            "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"R", "+", "50"}], ",", "\"\<y\>\"", ",", "1"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"drawEvent", "[", 
         RowBox[{"event", ",", "R"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"drawEvent", "[", 
         RowBox[{"reconEvent", ",", "R"}], "]"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{"drawEvent", "[", 
           RowBox[{"#", ",", "R"}], "]"}], "&"}], "/@", "rEvents"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"zu", ",", "R"}], "}"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.025"}], ",", "0"}], "}"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "L"}], "/", "2"}], ",", 
               RowBox[{"R", "+", "e"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"zu", ",", 
               RowBox[{"R", "+", "e"}]}], "}"}]}], "}"}], "]"}]}], "}"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.025"}], "}"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zu", ",", 
               RowBox[{"R", "+", "e"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"L", "/", "2"}], ",", 
               RowBox[{"R", "+", "e"}]}], "}"}]}], "}"}], "]"}]}], "}"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"zd", ",", 
             RowBox[{"-", "R"}]}], "}"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.025"}], ",", "0"}], "}"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "L"}], "/", "2"}], ",", 
               RowBox[{
                RowBox[{"-", "R"}], "-", "e"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"zd", ",", 
               RowBox[{
                RowBox[{"-", "R"}], "-", "e"}]}], "}"}]}], "}"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.025"}], "}"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zd", ",", 
               RowBox[{
                RowBox[{"-", "R"}], "-", "e"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"L", "/", "2"}], ",", 
               RowBox[{
                RowBox[{"-", "R"}], "-", "e"}]}], "}"}]}], "}"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(z\), \(u\)]\)\>\"", ",", "Medium"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"zu", ",", "R"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(z\), \(d\)]\)\>\"", ",", "Medium"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"zd", ",", 
            RowBox[{"-", "R"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
       "}"}]}]}], "]"}], "//", "Graphics"}]}]], "Input",
 CellChangeTimes->{{3.579147691646622*^9, 3.579147709546602*^9}, {
  3.579147990514357*^9, 3.579148096186045*^9}, {3.579148190766254*^9, 
  3.579148190991896*^9}, {3.579148274227846*^9, 3.579148304098861*^9}, {
  3.579148697041789*^9, 3.579148735914361*^9}, {3.57914882508869*^9, 
  3.579148827720453*^9}, {3.579184965227661*^9, 3.579185121449419*^9}, {
  3.579185163825814*^9, 3.579185422735683*^9}, {3.579185453475332*^9, 
  3.579185591745251*^9}, {3.579185628085356*^9, 3.57918566988596*^9}, {
  3.57918574319376*^9, 3.579185760518985*^9}, {3.579185800405533*^9, 
  3.579185814710694*^9}, {3.579185905916575*^9, 3.579186043971324*^9}, {
  3.57918641142518*^9, 3.579186439883657*^9}, {3.579186627221357*^9, 
  3.579186657054516*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"event", "=", 
        RowBox[{"{", 
         RowBox[{"100", ",", "40", ",", 
          RowBox[{
           RowBox[{"-", "15"}], " ", "Degree"}]}], "}"}]}], ",", 
       RowBox[{"R", "=", "450"}], ",", 
       RowBox[{"L", "=", "500"}], ",", "zu", ",", "zd", ",", "dl", ",", 
       RowBox[{"e", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"zu", ",", "zd", ",", "dl"}], "}"}], "=", 
       RowBox[{"toProjectionSpaceTheta", "[", 
        RowBox[{"event", ",", "R"}], "]"}]}], ";", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"drawDetector", "[", 
         RowBox[{"{", 
          RowBox[{"R", ",", "L"}], "}"}], "]"}], ",", " ", 
        RowBox[{"draw2DAxes", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{
             RowBox[{"L", "/", "2"}], "+", "50"}], ",", "\"\<z\>\"", ",", 
            "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"R", "+", "50"}], ",", "\"\<y\>\"", ",", "1"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], "&"}], "/@", 
         "rEvents"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"zu", ",", "R"}], "}"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.025"}], ",", "0"}], "}"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "L"}], "/", "2"}], ",", 
               RowBox[{"R", "+", "e"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"zu", ",", 
               RowBox[{"R", "+", "e"}]}], "}"}]}], "}"}], "]"}]}], "}"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.025"}], "}"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zu", ",", 
               RowBox[{"R", "+", "e"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"L", "/", "2"}], ",", 
               RowBox[{"R", "+", "e"}]}], "}"}]}], "}"}], "]"}]}], "}"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"zd", ",", 
             RowBox[{"-", "R"}]}], "}"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.025"}], ",", "0"}], "}"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "L"}], "/", "2"}], ",", 
               RowBox[{
                RowBox[{"-", "R"}], "-", "e"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"zd", ",", 
               RowBox[{
                RowBox[{"-", "R"}], "-", "e"}]}], "}"}]}], "}"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.025"}], "}"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zd", ",", 
               RowBox[{
                RowBox[{"-", "R"}], "-", "e"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"L", "/", "2"}], ",", 
               RowBox[{
                RowBox[{"-", "R"}], "-", "e"}]}], "}"}]}], "}"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(z\), \(u\)]\)\>\"", ",", "Medium"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"zu", ",", "R"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(z\), \(d\)]\)\>\"", ",", "Medium"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"zd", ",", 
            RowBox[{"-", "R"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
       "}"}]}]}], "]"}], "//", "Graphics"}]}]], "Input",
 CellChangeTimes->{{3.579147691646622*^9, 3.579147709546602*^9}, {
  3.579147990514357*^9, 3.579148096186045*^9}, {3.579148190766254*^9, 
  3.579148190991896*^9}, {3.579148274227846*^9, 3.579148304098861*^9}, {
  3.579148697041789*^9, 3.579148735914361*^9}, {3.57914882508869*^9, 
  3.579148827720453*^9}, {3.579184965227661*^9, 3.579185121449419*^9}, {
  3.579185163825814*^9, 3.579185422735683*^9}, {3.579185453475332*^9, 
  3.579185591745251*^9}, {3.579185628085356*^9, 3.57918566988596*^9}, {
  3.57918574319376*^9, 3.579185760518985*^9}, {3.579185800405533*^9, 
  3.579185814710694*^9}, {3.579185905916575*^9, 3.579186043971324*^9}, {
  3.57918641142518*^9, 3.579186439883657*^9}, {3.579186627221357*^9, 
  3.579186657054516*^9}, {3.579186727713411*^9, 3.57918680811113*^9}}]
},
WindowSize->{881, 867},
WindowMargins->{{Automatic, 114}, {Automatic, -1}},
FrontEndVersion->"8.0 for Linux x86 (32-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 771, 24, 69, "Input"],
Cell[1331, 46, 1050, 33, 69, "Input"],
Cell[2384, 81, 1434, 36, 88, "Input"],
Cell[3821, 119, 1314, 38, 88, "Input"],
Cell[5138, 159, 235, 6, 30, "Input"],
Cell[5376, 167, 1583, 41, 88, "Input"],
Cell[6962, 210, 6031, 162, 240, "Input"],
Cell[12996, 374, 117, 2, 30, "Input"],
Cell[13116, 378, 301, 8, 30, "Input"],
Cell[13420, 388, 336, 9, 30, "Input"],
Cell[13759, 399, 324, 8, 30, "Input"],
Cell[14086, 409, 367, 9, 30, "Input"],
Cell[14456, 420, 6225, 166, 278, "Input"],
Cell[20684, 588, 424, 12, 30, "Input"],
Cell[21111, 602, 6453, 172, 297, "Input"],
Cell[27567, 776, 6444, 172, 259, "Input"]
}
]
*)

(* End of internal cache information *)
