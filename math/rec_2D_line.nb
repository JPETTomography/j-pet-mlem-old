(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     51541,       1407]
NotebookOptionsPosition[     49467,       1348]
NotebookOutlinePosition[     49806,       1363]
CellTagsIndexPosition[     49763,       1360]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["This is a notebook acompanying the file rec_2D_line.tex", "Text",
 CellChangeTimes->{{3.57907518839357*^9, 3.579075226021987*^9}, {
   3.579173780896243*^9, 3.579173781854037*^9}, 3.579267367026761*^9}],

Cell[BoxData[
 RowBox[{"<<", "ellipse.m"}]], "Input",
 CellChangeTimes->{{3.580473677415807*^9, 3.580473679999479*^9}}],

Cell[BoxData[
 RowBox[{"<<", "CorrelatedGauss.m"}]], "Input",
 CellChangeTimes->{{3.580473519973394*^9, 3.580473621003083*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "P", "]"}]], "Input",
 CellChangeTimes->{{3.579268949416438*^9, 3.579268952065183*^9}}],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\<~/PET/pubs\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.579148871730551*^9, 3.579148883835647*^9}, 
   3.579267367027712*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.580473360583192*^9, 3.580473698910718*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"toProjectionSpaceTan", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"y_", ",", "z_", ",", "t_"}], "}"}], ",", "R_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"z", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"R", "-", "y"}], ")"}], "t"}]}], ",", " ", 
    RowBox[{"z", "-", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"R", "+", "y"}], ")"}], " ", "t"}]}], ",", 
    RowBox[{
     RowBox[{"-", "2"}], " ", "y", " ", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"t", "^", "2"}], "+", "1"}], "]"}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toProjectionSpaceTheta", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"y_", ",", "z_", ",", "\[Theta]_"}], "}"}], ",", "R_"}], "]"}], ":=", 
  RowBox[{"toProjectionSpaceTan", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"y", ",", "z", ",", 
      RowBox[{"Tan", "[", "\[Theta]", "]"}]}], "}"}], ",", "R"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.577068425291123*^9, 3.577068448103202*^9}, {
   3.57706847873517*^9, 3.577068497851817*^9}, {3.577068598631857*^9, 
   3.577068709085323*^9}, {3.577069333090607*^9, 3.577069372731426*^9}, {
   3.579085784355773*^9, 3.579085785835152*^9}, 3.579267367034789*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LabeledArrow", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"begin_", ",", "end_"}], "}"}], ",", "text_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Arrowheads", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", ".025"}], ",", ".025"}], "}"}], "]"}], ",", 
    RowBox[{"Arrow", "[", 
     RowBox[{"{", 
      RowBox[{"begin", ",", "end"}], "}"}], "]"}], ",", 
    RowBox[{"Text", "[", 
     RowBox[{"text", ",", 
      RowBox[{
       RowBox[{"1", "/", "2"}], 
       RowBox[{"(", 
        RowBox[{"begin", "+", "end"}], ")"}]}], ",", 
      RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], "}"}]}]], "Input",\

 CellChangeTimes->{{3.579147553155565*^9, 3.57914755517473*^9}, 
   3.579147592810015*^9, 3.579267367038327*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drawDetector", "[", 
   RowBox[{"{", 
    RowBox[{"R_", ",", "L_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "L"}], "/", "2"}], ",", "R"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"L", "/", "2"}], ",", "R"}], "}"}]}], "}"}], "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "L"}], "/", "2"}], ",", 
           RowBox[{"-", "R"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"L", "/", "2"}], ",", 
           RowBox[{"-", "R"}]}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.579147607808497*^9, 3.579147716718827*^9}, 
   3.579267367041969*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"draw2DAxes", "[", 
   RowBox[{"c_", ",", 
    RowBox[{"{", 
     RowBox[{"a1_", ",", "l1_", ",", "t1_", ",", 
      RowBox[{"s1_", " ", ":", " ", "0.1"}]}], " ", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a2_", ",", "l2_", ",", "t2_", ",", " ", 
      RowBox[{"s2_", " ", ":", " ", "0.1"}]}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Thickness", "[", "0.001", "]"}], ",", " ", 
      RowBox[{"Dashing", "[", "0.01", "]"}], ",", " ", 
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"c", "-", 
          RowBox[{"s1", "  ", "l1", " ", "a1"}]}], ",", 
         RowBox[{"c", "+", 
          RowBox[{"a1", " ", "l1"}]}]}], "}"}], "]"}], ",", " ", 
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"c", "-", 
          RowBox[{"s2", "  ", "l2", " ", "a2"}]}], ",", 
         RowBox[{"c", "+", 
          RowBox[{"a2", " ", "l2"}]}]}], "}"}], "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.579147796066277*^9, 3.5791478017894*^9}, {
   3.579147841346339*^9, 3.579147879145787*^9}, {3.579147934112458*^9, 
   3.579147986912305*^9}, {3.579148118723959*^9, 3.579148124248703*^9}, {
   3.579148159407291*^9, 3.579148265191451*^9}, {3.579148357760255*^9, 
   3.579148397116788*^9}, 3.579267367046408*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drawEvent", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"y_", ",", "z_", ",", "\[Theta]_"}], "}"}], ",", "R_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"zu", ",", "zd", ",", "dl", ",", "m"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zu", ",", "zd", ",", "dl"}], "}"}], "=", " ", 
      RowBox[{"toProjectionSpaceTheta", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"y", ",", "z", ",", "\[Theta]"}], "}"}], ",", "R"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"zu", ",", "R"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"zd", ",", 
            RowBox[{"-", "R"}]}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"Red", ",", 
         RowBox[{"PointSize", "[", "0.025", "]"}], ",", 
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"z", ",", "y"}], "}"}], "]"}]}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.579148499344023*^9, 3.579148693251192*^9}, {
   3.57914875489767*^9, 3.579148793853823*^9}, 3.579267367050915*^9}],

Cell[BoxData[
 RowBox[{"detector", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"drawDetector", "[", 
      RowBox[{"{", 
       RowBox[{"450", ",", "800"}], "}"}], "]"}], ",", " ", 
     RowBox[{"draw2DAxes", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", "450", ",", "\"\<z\>\"", ",", 
         "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", "500", ",", "\"\<y\>\"", ",", 
         "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"drawEvent", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"100", ",", "200", ",", 
         RowBox[{
          RowBox[{"-", "15"}], " ", "Degree"}]}], "}"}], ",", "450"}], 
      "]"}]}], "}"}], "//", "Graphics"}]}]], "Input",
 CellChangeTimes->{{3.579147691646622*^9, 3.579147709546602*^9}, {
   3.579147990514357*^9, 3.579148096186045*^9}, {3.579148190766254*^9, 
   3.579148190991896*^9}, {3.579148274227846*^9, 3.579148304098861*^9}, {
   3.579148697041789*^9, 3.579148735914361*^9}, {3.57914882508869*^9, 
   3.579148827720453*^9}, 3.579267367054507*^9}],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<detector.eps\>\"", ",", "detector", ",", "\"\<EPS\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.579148831045891*^9, 3.579148844623903*^9}, 
   3.579267367062816*^9}],

Cell[BoxData[
 RowBox[{"resolution", "=", 
  RowBox[{"{", 
   RowBox[{"10", ",", "50", ",", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.57908520840801*^9, 3.579085222236858*^9}, 
   3.579267367067767*^9, 3.57926866243201*^9, {3.580367943541769*^9, 
   3.580367946269964*^9}, {3.5804741009748*^9, 3.580474136348154*^9}, {
   3.580474228690815*^9, 3.58047423048169*^9}, {3.580474266238936*^9, 
   3.580474266346218*^9}, {3.580474363607544*^9, 3.580474364657914*^9}, {
   3.580474439204359*^9, 3.58047447339851*^9}, {3.58047508462133*^9, 
   3.580475090321586*^9}, 3.580492006596504*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fromProjectionSpaceTan", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zu_", ",", "zd_", ",", "dl_"}], "}"}], ",", "R_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", "y", ",", "z"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"zu", "-", "zd"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "R"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"y", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}], " ", 
         RowBox[{"dl", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "+", 
            RowBox[{"t", "^", "2"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"z", " ", "=", " ", 
        RowBox[{
         RowBox[{"1", "/", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{"zu", "+", "zd", "+", 
           RowBox[{"2", " ", "y", " ", "t"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"y", ",", "z", ",", "t"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fromProjectionSpaceTheta", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zu_", ",", "zd_", ",", "dl_"}], "}"}], ",", "R_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", "y", ",", "z"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"zu", "-", "zd"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "R"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"y", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}], " ", 
         RowBox[{"dl", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "+", 
            RowBox[{"t", "^", "2"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"z", " ", "=", " ", 
        RowBox[{
         RowBox[{"1", "/", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{"zu", "+", "zd", "+", 
           RowBox[{"2", " ", "y", " ", "t"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"y", ",", "z", ",", 
         RowBox[{"ArcTan", "[", "t", "]"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.579085790590607*^9, 3.579085955370314*^9}, {
   3.579085986986343*^9, 3.579085990824747*^9}, {3.579086060163592*^9, 
   3.579086060594517*^9}, {3.579173847043318*^9, 3.579173861738266*^9}, 
   3.579267367076181*^9, 3.580474426008891*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"toProjectionSpaceTan", "[", 
    RowBox[{
     RowBox[{"fromProjectionSpaceTan", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "200"}], ",", "300", ",", "100"}], "}"}], ",", "450"}], 
      "]"}], ",", "450"}], "]"}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.579085957580032*^9, 3.579086015807852*^9}, {
   3.579086072956252*^9, 3.579086080221511*^9}, 3.579267367078827*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"toProjectionSpaceTheta", "[", 
   RowBox[{
    RowBox[{"fromProjectionSpaceTheta", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "200"}], ",", "300", ",", 
        RowBox[{"20", " ", "Degree"}]}], "}"}], ",", "450"}], "]"}], ",", 
    "450"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.579173876191732*^9, 3.579173888145607*^9}, 
   3.57926736708393*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"aVec", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"y_", ",", "z_", ",", "\[Theta]_"}], "}"}], ",", "R_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"y", "-", "R"}], ",", " ", 
    RowBox[{"y", "+", "R"}], ",", " ", 
    RowBox[{"2", " ", "y", " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.57907529350655*^9, 3.579075339985362*^9}, {
   3.579092728856326*^9, 3.579092731470876*^9}, 3.579267367089271*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"bVec", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"y_", ",", "z_", ",", "\[Theta]_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"dy_", ",", "dz_"}], "}"}], ",", "R_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "dz"}], " ", "+", 
     RowBox[{"dy", " ", 
      RowBox[{"Tan", "[", "\[Theta]", "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"-", "dz"}], " ", "+", 
     RowBox[{"dy", " ", 
      RowBox[{"Tan", "[", "\[Theta]", "]"}]}]}], ",", 
    RowBox[{"2", " ", 
     RowBox[{"dy", "/", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.579075341899847*^9, 3.579075345144759*^9}, {
   3.579075464177303*^9, 3.579075539563891*^9}, {3.579075646935647*^9, 
   3.579075647258753*^9}, {3.579092735520378*^9, 3.579092738428499*^9}, 
   3.579267367092657*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"correlationMatrix", "[", 
   RowBox[{"{", 
    RowBox[{"sz_", ",", "sl_", ",", "\[Eta]_"}], "}"}], "]"}], "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sz", "^", "2"}], ",", "0", ",", "\[Eta]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"sz", "^", "2"}], ",", 
      RowBox[{"-", "\[Eta]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Eta]", ",", 
      RowBox[{"-", "\[Eta]"}], ",", 
      RowBox[{"sl", "^", "2"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.579075365894589*^9, 3.579075374272686*^9}, {
   3.579075406433549*^9, 3.579075454693501*^9}, 3.579267367095708*^9, {
   3.580480686605404*^9, 3.580480692116894*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"iC", "[", 
   RowBox[{"{", 
    RowBox[{"sz_", ",", "sl_", ",", "\[Eta]_"}], "}"}], "]"}], ":=", 
  RowBox[{"Inverse", "[", 
   RowBox[{"correlationMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"sz", ",", "sl", ",", "\[Eta]"}], "}"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.5790755525781*^9, 3.579075595320572*^9}, 
   3.579267367101487*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dtmin", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sz_", ",", "sl_", ",", "\[Eta]_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ty_", ",", "tz_", ",", "t\[Theta]_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"dy_", ",", "dz_"}], "}"}], ",", "R_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "a", ",", "ic"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ic", "=", 
       RowBox[{"iC", "[", 
        RowBox[{"{", 
         RowBox[{"sz", ",", "sl", ",", "\[Eta]"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"bVec", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ty", ",", "tz", ",", "t\[Theta]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"dy", ",", "dz"}], "}"}], ",", "R"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"aVec", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ty", ",", "tz", ",", "t\[Theta]"}], "}"}], ",", "R"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"b", ".", "ic", ".", "a"}], "/", 
       RowBox[{"a", ".", "ic", ".", "a"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.57907563046715*^9, 3.579075806742935*^9}, 
   3.579267367106524*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaussian", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sz_", ",", "sl_", ",", "\[Eta]_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"ty_", ",", "tz_", ",", "t\[Theta]_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"dy_", ",", "dz_"}], "}"}], ",", "R_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"b", ",", "a", ",", "ic"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ic", "=", 
      RowBox[{"iC", "[", 
       RowBox[{"{", 
        RowBox[{"sz", ",", "sl", ",", "\[Eta]"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"bVec", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ty", ",", "tz", ",", "t\[Theta]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"dy", ",", "dz"}], "}"}], ",", "R"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"aVec", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ty", ",", "tz", ",", "t\[Theta]"}], "}"}], ",", "R"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"b", ".", "ic", ".", "b"}], " ", "-", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"b", ".", "ic", ".", "a"}], ")"}], "^", "2"}], "/", 
         RowBox[{"a", ".", "ic", ".", "a"}]}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.579076105052227*^9, 3.579076159923231*^9}, 
   3.579076220360842*^9, 3.579267367116958*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gaussian", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"30", ",", "100", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"200", ",", "100", ",", 
       RowBox[{"0", " ", "Degree"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"dy", ",", "dz"}], "}"}], ",", "450"}], "]"}], " ", "//", 
   "Expand"}], " ", "//", "N"}]], "Input",
 CellChangeTimes->{{3.579076172455714*^9, 3.579076177653083*^9}, {
   3.579076213281821*^9, 3.579076215905168*^9}, 3.579267367119773*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"approximateP", "[", 
   RowBox[{"s_", ",", "meas_", ",", 
    RowBox[{"{", 
     RowBox[{"y_", ",", "z_"}], "}"}], ",", "R_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ic", ",", "a", ",", "b", ",", "diff", ",", "tmin"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ic", "=", 
      RowBox[{"iC", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"aVec", "[", 
       RowBox[{"meas", ",", "R"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"diff", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"y", "-", 
         RowBox[{"meas", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"z", "-", 
         RowBox[{"meas", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"bVec", "[", 
       RowBox[{"meas", ",", "diff", ",", "R"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmin", "=", 
      RowBox[{
       RowBox[{"meas", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "+", 
       RowBox[{"dtmin", "[", 
        RowBox[{"s", ",", "meas", ",", "diff", ",", "R"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"Det", "[", "ic", "]"}], "/", 
         RowBox[{"a", ".", "ic", ".", "a"}]}], "]"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", 
         RowBox[{"Pi", "^", "2"}]}], ")"}]}], " ", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"tmin", "^", "2"}]}], ")"}]}], " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"gaussian", "[", 
         RowBox[{"s", ",", "meas", ",", "diff", ",", "R"}], "]"}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.579088229221625*^9, 3.579088260087191*^9}, {
   3.5790882922391*^9, 3.579088559728732*^9}, {3.579088692654379*^9, 
   3.579088693036993*^9}, 3.579267367129191*^9, {3.580367879745819*^9, 
   3.580367882810392*^9}, {3.580367918233021*^9, 3.580367920153944*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"errorFunction", "[", 
   RowBox[{"meas_", ",", 
    RowBox[{"{", 
     RowBox[{"y_", ",", "z_"}], "}"}], ",", "s_", ",", "R_", ",", "t_"}], 
   "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f", ",", "err", ",", "true"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"true", "=", 
      RowBox[{"toProjectionSpaceTan", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"y", ",", "z", ",", "t"}], "}"}], ",", "R"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"err", "=", " ", 
      RowBox[{"meas", "-", "true"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"err", ".", 
        RowBox[{"iC", "[", "s", "]"}], ".", "err"}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.579084935126416*^9, 3.579084936062737*^9}, {
   3.579091132967556*^9, 3.579091135004557*^9}, {3.579091383241335*^9, 
   3.579091384853859*^9}, 3.579267367138588*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"P", "[", 
   RowBox[{"s_", ",", "meas_", ",", 
    RowBox[{"{", 
     RowBox[{"y_", ",", "z_", ",", "\[Theta]_"}], "}"}], ",", "R_"}], "]"}], ":=",
   " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f", ",", "ic"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ic", "=", 
      RowBox[{"iC", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{"errorFunction", "[", 
       RowBox[{
        RowBox[{"toProjectionSpaceTheta", "[", 
         RowBox[{"meas", ",", "R"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "z"}], "}"}], ",", "s", ",", "R", ",", 
        RowBox[{"Tan", "[", "\[Theta]", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"Det", "[", "ic", "]"}], "]"}], "/", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"2", " ", "Pi"}], "]"}], "^", "3"}]}], " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", "f"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.579085022988882*^9, 3.579085184981244*^9}, {
   3.57908530003073*^9, 3.57908533776946*^9}, {3.57908537855304*^9, 
   3.579085415089225*^9}, {3.579085458116442*^9, 3.579085543345108*^9}, {
   3.57908694746663*^9, 3.57908697235166*^9}, {3.579091362161657*^9, 
   3.579091363774957*^9}, {3.579091402896015*^9, 3.579091404868285*^9}, 
   3.57926736714297*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.579085686542946*^9, 3.579085687852375*^9}, 
   3.579267367151292*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"P", "[", 
   RowBox[{"s_", ",", "meas_", ",", 
    RowBox[{"{", 
     RowBox[{"y_", ",", "z_"}], "}"}], ",", "R_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f", ",", "ic"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{"s", ",", "meas", ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "z", ",", "\[Theta]"}], "}"}], ",", "R"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", 
         RowBox[{
          RowBox[{"-", "Pi"}], "/", "2"}], ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}]}], "]"}], "/", "Pi"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.579085022988882*^9, 3.579085184981244*^9}, {
   3.57908530003073*^9, 3.57908533776946*^9}, {3.57908537855304*^9, 
   3.579085415089225*^9}, {3.579085447772736*^9, 3.57908545345671*^9}, {
   3.579085557258522*^9, 3.579085598138688*^9}, {3.579085696170433*^9, 
   3.579085703706162*^9}, {3.579086810187594*^9, 3.57908681080798*^9}, {
   3.579088620845152*^9, 3.579088637703285*^9}, 3.579267367154998*^9}],

Cell[BoxData[
 RowBox[{"NIntegrate", "[", 
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{"resolution", ",", 
     RowBox[{"fromProjectionSpaceTheta", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"zu", ",", "zd", ",", "dl"}], "}"}], ",", "450"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"30", "Degree"}]}], "}"}], ",", "450"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"zu", ",", 
     RowBox[{"-", "500"}], ",", "500"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"zd", ",", 
     RowBox[{"-", "500"}], ",", "500"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"dl", ",", " ", 
     RowBox[{"-", "750"}], ",", "750"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.579086233424986*^9, 3.579086280401224*^9}, {
   3.579086312718594*^9, 3.579086320552788*^9}, {3.579086421664199*^9, 
   3.579086433003785*^9}, {3.579086476648148*^9, 3.579086494991062*^9}, {
   3.579086576340393*^9, 3.579086608100185*^9}, {3.57908676280347*^9, 
   3.579086771378915*^9}, {3.579086867373889*^9, 3.57908687135004*^9}, {
   3.579087005924788*^9, 3.579087022071212*^9}, {3.579173823138326*^9, 
   3.579173833951504*^9}, {3.579173900161364*^9, 3.579173900716356*^9}, 
   3.57926736716848*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.57908704545439*^9, 3.579087124283123*^9}, {
   3.579087206815164*^9, 3.579087209489637*^9}, {3.579087253892175*^9, 
   3.579087256120028*^9}, {3.579087320166432*^9, 3.579087321229166*^9}, {
   3.579087447364914*^9, 3.579087451486279*^9}, {3.5790876404756*^9, 
   3.579087641510273*^9}, {3.579087678374439*^9, 3.579087683718006*^9}, {
   3.579087734555704*^9, 3.579087777945483*^9}, 3.579173819255978*^9, 
   3.579267367173164*^9}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{"resolution", ",", 
       RowBox[{"{", 
        RowBox[{"300", ",", "0", ",", 
         RowBox[{"25", "Degree"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"350", ",", "z"}], "}"}], ",", "450"}], "]"}], ",", 
     RowBox[{"approximateP", "[", 
      RowBox[{"resolution", ",", 
       RowBox[{"{", 
        RowBox[{"300", ",", "0", ",", 
         RowBox[{"25", "Degree"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"350", ",", "z"}], "}"}], ",", "450"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", 
     RowBox[{"-", "20"}], ",", "50"}], "}"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Red", ",", " ", "Blue"}], "}"}]}], ",", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.579087396225907*^9, 3.579087416394327*^9}, {
   3.579087460621189*^9, 3.579087461215471*^9}, {3.579173996907805*^9, 
   3.579174007438338*^9}, {3.579174089287797*^9, 3.579174102037261*^9}, {
   3.579174224982029*^9, 3.579174231277794*^9}, 3.579267367176483*^9, {
   3.580367983751871*^9, 3.580367989672913*^9}, {3.580474156355816*^9, 
   3.580474209121103*^9}, {3.580474313152117*^9, 3.580474331518479*^9}, {
   3.580475115060748*^9, 3.580475126369214*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"compare", "[", 
   RowBox[{"s_", ",", "meas_", ",", 
    RowBox[{"{", 
     RowBox[{"y_", ",", "z_"}], "}"}], ",", "R_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"e", ",", "a"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"e", "=", 
      RowBox[{"P", "[", 
       RowBox[{"s", ",", "meas", ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "z"}], "}"}], ",", "R"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"approximateP", "[", 
       RowBox[{"s", ",", "meas", ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "z"}], "}"}], ",", "R"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e", ",", "a", ",", 
        RowBox[{"a", "-", "e"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"a", "-", "e"}], ")"}], "/", "e"}]}], "}"}], "//", 
      "N"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.579088879848075*^9, 3.579088986031071*^9}, 
   3.579267367202037*^9}],

Cell[BoxData[
 RowBox[{"compare", "[", 
  RowBox[{"resolution", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"15", " ", "Degree"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", "450"}], "]"}]], "Input",
 CellChangeTimes->{{3.579088959840658*^9, 3.57908911271633*^9}, {
   3.579089171033951*^9, 3.579089189406413*^9}, {3.579091431694727*^9, 
   3.579091437762716*^9}, {3.579091485833916*^9, 3.579091506016796*^9}, 
   3.579267367203117*^9, {3.579268753293751*^9, 3.57926876194279*^9}, {
   3.580476302118335*^9, 3.580476302220497*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.500285915176587`*^-7", ",", "1.5051138774171858`*^-7", ",", 
   "4.827962240598746`*^-10", ",", "0.0032180281050165583`"}], "}"}]], "Input",\

 CellChangeTimes->{3.580476430295663*^9}],

Cell[BoxData[
 RowBox[{"compare", "[", 
  RowBox[{"resolution", ",", 
   RowBox[{"{", 
    RowBox[{"300", ",", "0", ",", 
     RowBox[{"20", " ", "Degree"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"320", ",", "10"}], "}"}], ",", "450"}], "]"}]], "Input",
 CellChangeTimes->{{3.579088959840658*^9, 3.579089070114631*^9}, {
   3.579091515196518*^9, 3.579091543788045*^9}, {3.579092767373421*^9, 
   3.579092775666521*^9}, {3.579173950555585*^9, 3.579173958397504*^9}, {
   3.579174074470489*^9, 3.579174077050023*^9}, 3.579267367205303*^9, {
   3.580476306681491*^9, 3.580476336873202*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"coeffs", "[", 
   RowBox[{"form_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}]}], "]"}], ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"form", ",", 
      RowBox[{"x", "^", "2"}]}], "]"}], ",", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"form", ",", 
      RowBox[{"y", "^", "2"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{"form", ",", 
       RowBox[{"x", " ", "y"}]}], "]"}], "/", "2"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.579267384465588*^9, 3.579267410917011*^9}, {
  3.579267448829323*^9, 3.579267503804219*^9}, {3.57926755249619*^9, 
  3.579267611848295*^9}, {3.579267947728933*^9, 3.579268039657705*^9}, {
  3.579268530530212*^9, 3.579268541654219*^9}, {3.579269770569763*^9, 
  3.579269773734761*^9}, {3.579269816392667*^9, 3.579269855538842*^9}, {
  3.580476413238147*^9, 3.580476427086715*^9}, {3.580477407533272*^9, 
  3.580477461776385*^9}, {3.580477947882463*^9, 3.580477953846754*^9}, {
  3.58047832874083*^9, 3.580478328945294*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"caseStudy", "[", 
   RowBox[{"s_", ",", "meas_", ",", "R_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "el", ",", "g", ",", "y", ",", "z", ",", "a", ",", "b", ",", "c", ",", 
      RowBox[{"p", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"meas", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"meas", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ",", "limits"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"g", "=", 
      RowBox[{"gaussian", "[", 
       RowBox[{"s", ",", "meas", ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "z"}], "}"}], ",", "R"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
      RowBox[{
       RowBox[{"coeffs", "[", 
        RowBox[{"g", ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", "y"}], "}"}]}], "]"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "a", ",", "\"\< \>\"", " ", ",", "b", ",", "\"\< \>\"", ",", "c"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"el", "=", 
      RowBox[{"reconstructEllipse", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "el", ";", "\[IndentingNewLine]", 
     RowBox[{"limits", "=", 
      RowBox[{"ellipseLimits", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"drawDetector", "[", 
           RowBox[{"{", 
            RowBox[{"450", ",", "300"}], "}"}], "]"}], ",", 
          RowBox[{"drawEvent", "[", 
           RowBox[{"meas", ",", "R"}], "]"}], ",", 
          RowBox[{"ellipse", "[", 
           RowBox[{"p", ",", "a", ",", "b", ",", "c", ",", "1"}], "]"}], ",", 
          
          RowBox[{"ellipse", "[", 
           RowBox[{"p", ",", "a", ",", "b", ",", "c", ",", "3"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Thin", ",", 
            RowBox[{"ellipseBoundingBox", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "3", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"meas", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"meas", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "Gray"}], 
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p", "-", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "3"}], "}"}], " ", "limits"}]}], " ", ",", 
             RowBox[{"p", "+", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "3"}], "}"}], "limits"}]}]}], "}"}],
            "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p", "-", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "3"}], "}"}], " ", "limits"}]}], " ", ",", 
             RowBox[{"p", "+", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "3"}], "}"}], "limits"}]}]}], "}"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p", "-", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "3"}], "}"}], " ", "limits"}]}], 
             " ", ",", 
             RowBox[{"p", "+", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "3"}], "}"}], "limits"}]}]}], "}"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p", "-", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"3", ",", "1"}], "}"}], "limits"}]}], ",", 
             RowBox[{"p", "+", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"3", ",", 
                 RowBox[{"-", "1"}]}], "}"}], "limits"}]}]}], "}"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p", "-", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"3", ",", "0"}], "}"}], "limits"}]}], ",", 
             RowBox[{"p", "+", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"3", ",", "0"}], "}"}], "limits"}]}]}], "}"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p", "-", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"3", ",", 
                 RowBox[{"-", "1"}]}], "}"}], "limits"}]}], ",", 
             RowBox[{"p", "+", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"3", ",", "1"}], "}"}], "limits"}]}]}], "}"}], 
           "]"}]}], "\[IndentingNewLine]", "}"}], "//", "Graphics"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"GraphicsGrid", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"P", "[", 
                  RowBox[{"s", ",", "meas", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"meas", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{"q", " ", 
                    RowBox[{"limits", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "z"}], "}"}], 
                   ",", "R"}], "]"}], ",", 
                 RowBox[{"approximateP", "[", 
                  RowBox[{"s", ",", "meas", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"meas", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{"q", " ", 
                    RowBox[{"limits", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "z"}], "}"}], 
                   ",", "R"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"z", ",", " ", 
                 RowBox[{
                  RowBox[{"meas", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"3", 
                   RowBox[{"limits", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"meas", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "+", 
                  RowBox[{"3", 
                   RowBox[{"limits", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}], ",", 
               RowBox[{"PlotRange", "->", "All"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Red", ",", "Blue"}], "}"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"q", ",", 
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"P", "[", 
                  RowBox[{"s", ",", "meas", ",", 
                   RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{
                    RowBox[{"meas", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    RowBox[{"q", " ", 
                    RowBox[{"limits", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}], ",", "R"}], 
                  "]"}], ",", 
                 RowBox[{"approximateP", "[", 
                  RowBox[{"s", ",", "meas", ",", 
                   RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{
                    RowBox[{"meas", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    RowBox[{"q", " ", 
                    RowBox[{"limits", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}], ",", "R"}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y", ",", " ", 
                 RowBox[{
                  RowBox[{"meas", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", 
                  RowBox[{"3", 
                   RowBox[{"limits", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"meas", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "+", 
                  RowBox[{"3", 
                   RowBox[{"limits", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}], ",", 
               RowBox[{"PlotRange", "->", "All"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Red", ",", "Blue"}], "}"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"q", ",", 
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], "//", "Transpose"}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.580476645845137*^9, 3.580476701510421*^9}, {
   3.580476991858084*^9, 3.580477018710421*^9}, {3.58047729578177*^9, 
   3.580477345760888*^9}, {3.580477387624128*^9, 3.580477390212572*^9}, {
   3.580477469623081*^9, 3.580477482761695*^9}, {3.580477809491113*^9, 
   3.580477811780659*^9}, {3.580477844022321*^9, 3.580477884468837*^9}, {
   3.580478023937936*^9, 3.580478070716549*^9}, {3.580478145199458*^9, 
   3.58047815116175*^9}, {3.58047818323432*^9, 3.58047818471356*^9}, {
   3.580478258278011*^9, 3.580478263153411*^9}, {3.58047833838673*^9, 
   3.580478413750334*^9}, {3.580478445730671*^9, 3.580478463229189*^9}, {
   3.580478507228963*^9, 3.580478507542825*^9}, {3.580478700418703*^9, 
   3.58047872100081*^9}, {3.580493442488585*^9, 3.580493473249911*^9}, {
   3.580493583965768*^9, 3.580493599409315*^9}, {3.580493649583082*^9, 
   3.580493673492772*^9}, {3.580493723545005*^9, 3.580493748080782*^9}, {
   3.580493926634753*^9, 3.580493955382031*^9}, {3.580494448156092*^9, 
   3.580494595489041*^9}, {3.580494636724078*^9, 3.580494652047*^9}, 
   3.58049587671991*^9, {3.580496107392704*^9, 3.580496136880799*^9}, {
   3.580547710079002*^9, 3.580547828744976*^9}, {3.580547863385528*^9, 
   3.580547969234432*^9}, {3.580548030893464*^9, 3.580548227151101*^9}, {
   3.580548383722352*^9, 3.580548469701971*^9}, {3.580548818468112*^9, 
   3.580549010480631*^9}, {3.580549111499434*^9, 3.580549120570458*^9}, {
   3.580549481499405*^9, 3.580549524601032*^9}, {3.580549688764797*^9, 
   3.58054974176834*^9}, {3.580549866238693*^9, 3.580549868026314*^9}, {
   3.580550560318267*^9, 3.580550580247934*^9}, {3.580564160535799*^9, 
   3.580564166333306*^9}, {3.580564308143676*^9, 3.580564320835756*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cs", "[", "1", "]"}], "=", 
  RowBox[{"caseStudy", "[", 
   RowBox[{"resolution", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"0", "Degree"}]}], "}"}], ",", "450"}], "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAmIQvXB11xfzta8chQ9v+QWiM2IL4yyAdMtphngQ/cvV
LAVEr/X1ANOWMnOqQLRGrWsNiOYr7W0A0VsWWbeB6etPukD0WQWdPhCdtrhj
CohOllkBptl2TC62BNIBCd4lIPphvtBMEM24oQhMm7u3q9sD6a1LpDVBNM+B
yatA9ITvB8H05ReeN0D0+4/Hb4NoteKepyCan0f2JYiuEr/5FkTPP/P2A4h+
sDvoD4j+55z4F0RP5zvA5QCkn757yg2inVmcfEH06wnNYPrC9tXeUUDayf4K
mLaQ54kB0eZ/3cH04X8cvSD6pIwVmOaKXlwdDaSPBq8A0xeupbaCaOZDz9pA
tJeG01QQzZhTAKbvRCTMAtFfVxvPBdEHH2svAdGs55iXgeiXK6qjkoD0/zfz
wDQACQzZeQ==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"cs", "[", "2", "]"}], "=", 
  RowBox[{"caseStudy", "[", 
   RowBox[{"resolution", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"18", "Degree"}]}], "}"}], ",", "450"}], "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAmIQvXB11xfzta8chQ9v+QWiM2IL4yyAdMtphngQ/cvV
LAVEr/X1ANOWMnOqQLRGrWsNiOYr7W0A0VsWWbeB6etPukD0WQWdPhCdtrhj
CohOllkBptl2TC62BNIBCd4lIPphvtBMEM24oQhMm7u3q9sD6a1LpDVBNM+B
yatA9ITvB8H05ReeN0D0+4/Hb4NoteKepyCan0f2JYiuEr/5FkTPP/P2A4h+
sDvoD4j+55z4F0RP5zvA5QCkn757yg2inVmcfEH06wnNYPrC9tXeUUDayf4K
mLaQ54kB0eZ/3cH04X8cvSD6pIwVmOaKXlwdDaSPBq8A0xeupbaCaOZDz9pA
tJeG01QQzZhTAKbvRCTMAtGSBUvngujEQJnFIPqV99GlILpixrfoJJB/+ERj
QDQA11LWmw==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"cs", "[", "3", "]"}], "=", 
  RowBox[{"caseStudy", "[", 
   RowBox[{"resolution", ",", 
    RowBox[{"{", 
     RowBox[{"300", ",", "0", ",", 
      RowBox[{"0", "Degree"}]}], "}"}], ",", "450"}], "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQvXB11xfzta8chQ9v+QWiM2IL4yyAdMtphngQ/cvV
LAVEr/X1ANOWMnOqQLRGrWsNiOYr7W0A0VsWWbeB6etPukD0WQWdPhCdtrhj
CohOllkBptl2TC62BNIBCd4lIPphvtBMEM24oQhMm7u3q9sD6a1LpDVBNM+B
yatA9ITvB8H05ReeN0D0+4/Hb4NoteKepyCan0f2JYiuEr/5FkTPP/P2A4h+
sDvoD4j+55z4F0RP5zvA5QCkn757yg2inVmcfEH06wnNYPrC9tXeUUDayf4K
mLaQ54kB0eZ/3cH04X8cvSD6pIwVmOaKXlwdDaSPBq8A0xeupbaCaOZDz9pA
tJeG01QQzZhTAKYPGUxcDKIrcreuANFVF/fHJAFpGZ6HYBoArjbPbw==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"cs", "[", "4", "]"}], "=", 
  RowBox[{"caseStudy", "[", 
   RowBox[{"resolution", ",", 
    RowBox[{"{", 
     RowBox[{"300", ",", "0", ",", 
      RowBox[{"10", "Degree"}]}], "}"}], ",", "450"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.580550458778416*^9, 3.58055046627577*^9}, {
  3.580564203642951*^9, 3.580564204800831*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.580550876574467*^9, 3.58055087753475*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"\"\<cs_ev\>\"", "<>", 
       RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.eps\>\""}], ",", 
      RowBox[{
       RowBox[{"cs", "[", "i", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<EPS\>\""}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"\"\<cs_pl\>\"", "<>", 
       RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.eps\>\""}], ",", 
      RowBox[{
       RowBox[{"cs", "[", "i", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<EPS\>\""}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.580550867464251*^9, 3.580550942394429*^9}, {
  3.580550979826804*^9, 3.58055099196405*^9}, {3.580561525103877*^9, 
  3.580561535781709*^9}, {3.580561579758666*^9, 3.580561585375473*^9}, {
  3.580561639146783*^9, 3.580561641001722*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"z_", ",", "L_", ",", "a_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "2"}], " ", 
    RowBox[{
     RowBox[{"a", "^", "2"}], " ", "/", 
     RowBox[{"L", "^", "2"}]}], " ", 
    RowBox[{"z", "^", "2"}]}], " ", "+", " ", 
   RowBox[{"2", " ", 
    RowBox[{
     RowBox[{"a", "^", "2"}], "/", "L"}], " ", "z"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"a", "^", "2"}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.580614861528702*^9, 3.580614884652037*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"z", ",", "350", ",", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"1.25", "^", "2"}], "-", "1"}], "]"}]}], "]"}], ",", 
     RowBox[{"f", "[", 
      RowBox[{
       RowBox[{"-", "z"}], ",", "350", ",", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"1.25", "^", "2"}], "-", "1"}], "]"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", 
     RowBox[{"-", "150"}], ",", "150"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.580614513334258*^9, 3.580614648224689*^9}, {
  3.580614685289422*^9, 3.580614685912403*^9}, {3.580614919060633*^9, 
  3.58061492004367*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"z", ",", "350", ",", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"1.25", "^", "2"}], "-", "1"}], "]"}]}], "]"}], "-", 
     RowBox[{"f", "[", 
      RowBox[{
       RowBox[{"-", "z"}], ",", "350", ",", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"1.25", "^", "2"}], "-", "1"}], "]"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", 
     RowBox[{"-", "150"}], ",", "150"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.580614513334258*^9, 3.580614648224689*^9}, {
  3.580614685289422*^9, 3.580614685912403*^9}, {3.580614987520756*^9, 
  3.580614995908967*^9}}]
},
WindowSize->{1131, 1000},
WindowMargins->{{Automatic, 332}, {Automatic, 27}},
FrontEndVersion->"8.0 for Linux x86 (32-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 208, 2, 30, "Text"],
Cell[768, 24, 119, 2, 30, "Input"],
Cell[890, 28, 127, 2, 30, "Input"],
Cell[1020, 32, 124, 2, 30, "Input"],
Cell[1147, 36, 174, 3, 30, "Input"],
Cell[1324, 41, 90, 1, 30, "Input"],
Cell[1417, 44, 1295, 36, 69, "Input"],
Cell[2715, 82, 793, 24, 50, "Input"],
Cell[3511, 108, 1076, 34, 69, "Input"],
Cell[4590, 144, 1460, 36, 69, "Input"],
Cell[6053, 182, 1337, 38, 88, "Input"],
Cell[7393, 222, 1243, 33, 50, "Input"],
Cell[8639, 257, 223, 5, 30, "Input"],
Cell[8865, 264, 588, 10, 30, "Input"],
Cell[9456, 276, 2779, 77, 259, "Input"],
Cell[12238, 355, 495, 13, 50, "Input"],
Cell[12736, 370, 437, 12, 30, "Input"],
Cell[13176, 384, 506, 13, 30, "Input"],
Cell[13685, 399, 870, 24, 30, "Input"],
Cell[14558, 425, 738, 20, 30, "Input"],
Cell[15299, 447, 387, 11, 30, "Input"],
Cell[15689, 460, 1436, 40, 145, "Input"],
Cell[17128, 502, 1620, 46, 126, "Input"],
Cell[18751, 550, 536, 14, 30, "Input"],
Cell[19290, 566, 2187, 59, 164, "Input"],
Cell[21480, 627, 1067, 29, 107, "Input"],
Cell[22550, 658, 1488, 38, 107, "Input"],
Cell[24041, 698, 118, 2, 30, "Input"],
Cell[24162, 702, 1196, 29, 69, "Input"],
Cell[25361, 733, 1223, 28, 50, "Input"],
Cell[26587, 763, 479, 7, 30, "Input"],
Cell[27069, 772, 1352, 32, 50, "Input"],
Cell[28424, 806, 1078, 32, 88, "Input"],
Cell[29505, 840, 586, 12, 30, "Input"],
Cell[30094, 854, 229, 6, 30, "Input"],
Cell[30326, 862, 593, 12, 30, "Input"],
Cell[30922, 876, 1087, 25, 30, "Input"],
Cell[32012, 903, 11687, 279, 506, "Input"],
Cell[43702, 1184, 730, 17, 30, "Input"],
Cell[44435, 1203, 731, 17, 30, "Input"],
Cell[45169, 1222, 715, 16, 30, "Input"],
Cell[45887, 1240, 364, 9, 30, "Input"],
Cell[46254, 1251, 91, 1, 30, "Input"],
Cell[46348, 1254, 1028, 25, 69, "Input"],
Cell[47379, 1281, 607, 19, 30, "Input"],
Cell[47989, 1302, 735, 21, 30, "Input"],
Cell[48727, 1325, 736, 21, 30, "Input"]
}
]
*)

(* End of internal cache information *)
