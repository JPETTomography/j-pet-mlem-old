(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11923,        386]
NotebookOptionsPosition[     11077,        351]
NotebookOutlinePosition[     11432,        367]
CellTagsIndexPosition[     11389,        364]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"R", "=", 
   RowBox[{"RotationMatrix", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.639279515380188*^9, 3.639279543346858*^9}, {
  3.639408328930537*^9, 3.639408333936446*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"R", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"R", ",", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "\[Element]", " ", "Reals"}], " ", ")"}], " ", "&&", " ", 
     RowBox[{"(", " ", 
      RowBox[{"y", " ", "\[Element]", " ", "Reals"}], ")"}], "  ", "&&", " ", 
     
     RowBox[{"z", " ", "\[Element]", " ", "Reals"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6392795858585157`*^9, 3.6392796378365498`*^9}, {
  3.639279677630888*^9, 3.639279680576373*^9}, {3.639408303046123*^9, 
  3.639408305790421*^9}, {3.639408337800085*^9, 3.6394083634231157`*^9}, {
  3.639408418605981*^9, 3.6394084761948557`*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.639279658472437*^9, {3.639408302640993*^9, 3.6394084471030188`*^9}, 
   3.639408477366294*^9, 3.639733389011726*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"R", ",", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"x", "^", "2"}], "+", 
      RowBox[{"y", "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}]}], ")"}], "\[Equal]", "1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.639279826842308*^9, 3.6392798299091454`*^9}, {
  3.6392798632791767`*^9, 3.63927987675563*^9}, {3.639408497702146*^9, 
  3.639408498065641*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["x", "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"x", " ", "y"}], "-", 
      RowBox[{"x", " ", "y", " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
      RowBox[{"z", " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ",", 
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"y", " ", 
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}], "+", 
        RowBox[{"x", " ", "z", " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x", " ", "y"}], "-", 
      RowBox[{"x", " ", "y", " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
      RowBox[{"z", " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["y", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ")"}]}], "+", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"2", " ", "y", " ", "z", " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         FractionBox["\[Phi]", "2"], "]"}], "2"]}], "-", 
      RowBox[{"x", " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "y"}], " ", 
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}], "+", 
        RowBox[{"x", " ", "z", " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", " ", 
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}], "+", 
        RowBox[{"y", " ", "z", " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["z", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ")"}]}], "+", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.639279882055757*^9, 3.639408303582863*^9, 
  3.63940849886812*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.639279898204502*^9, 3.6392799018992977`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], 
      RowBox[{
       RowBox[{"x", " ", "y"}], "-", 
       RowBox[{"x", " ", "y", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
       RowBox[{"z", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], 
      RowBox[{"2", " ", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"y", " ", 
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}]}], "+", 
         RowBox[{"x", " ", "z", " ", 
          RowBox[{"Sin", "[", 
           FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]},
     {
      RowBox[{
       RowBox[{"x", " ", "y"}], "-", 
       RowBox[{"x", " ", "y", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{"z", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["y", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ")"}]}], "+", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], 
      RowBox[{
       RowBox[{"2", " ", "y", " ", "z", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}], "2"]}], "-", 
       RowBox[{"x", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]},
     {
      RowBox[{"2", " ", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "y"}], " ", 
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}]}], "+", 
         RowBox[{"x", " ", "z", " ", 
          RowBox[{"Sin", "[", 
           FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", " ", 
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}]}], "+", 
         RowBox[{"y", " ", "z", " ", 
          RowBox[{"Sin", "[", 
           FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ")"}]}], "+", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6392799028718233`*^9, 3.639408303620129*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rotation", "[", 
    RowBox[{"v1_", ",", " ", "v2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ax", "=", 
        RowBox[{"Cross", "[", 
         RowBox[{"v1", ",", "v2"}], "]"}]}], ",", "s", ",", "c"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", "=", 
       RowBox[{"Norm", "[", "ax", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"Dot", "[", 
        RowBox[{"v1", ",", "v2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ax", "=", 
       RowBox[{"Normalize", "[", "ax", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"ax", ",", " ", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"c", ",", "s"}], "]"}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.639408836985661*^9, 3.639408988349476*^9}, {
  3.639409080612605*^9, 3.639409082574518*^9}, {3.639409125792762*^9, 
  3.6394091513758593`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rotation", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.639408990225525*^9, 3.639409035082247*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
   FractionBox["\[Pi]", "2"]}], "}"}]], "Output",
 CellChangeTimes->{3.639409035747201*^9, 3.6394090856470213`*^9, 
  3.6394091543496037`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cross", "[", 
  RowBox[{
   RowBox[{"Array", "[", 
    RowBox[{"v", ",", "3"}], "]"}], ",", " ", 
   RowBox[{"Array", "[", 
    RowBox[{"w", ",", "3"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.639409211739943*^9, 3.639409240117244*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"v", "[", "3", "]"}]}], " ", 
     RowBox[{"w", "[", "2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"v", "[", "2", "]"}], " ", 
     RowBox[{"w", "[", "3", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"v", "[", "3", "]"}], " ", 
     RowBox[{"w", "[", "1", "]"}]}], "-", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], " ", 
     RowBox[{"w", "[", "3", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"v", "[", "2", "]"}]}], " ", 
     RowBox[{"w", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], " ", 
     RowBox[{"w", "[", "2", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.639409241110634*^9}]
}, Open  ]]
},
WindowSize->{808, 982},
WindowMargins->{{4, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 317, 8, 28, "Input"],
Cell[CellGroupData[{
Cell[900, 32, 650, 14, 28, "Input"],
Cell[1553, 48, 176, 3, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1766, 56, 429, 11, 28, "Input"],
Cell[2198, 69, 2803, 85, 161, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5038, 159, 127, 2, 28, "Input"],
Cell[5168, 163, 3213, 94, 91, "Output"]
}, Open  ]],
Cell[8396, 260, 1047, 28, 114, "Input"],
Cell[CellGroupData[{
Cell[9468, 292, 268, 7, 28, "Input"],
Cell[9739, 301, 251, 7, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10027, 313, 268, 7, 28, "Input"],
Cell[10298, 322, 763, 26, 28, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
