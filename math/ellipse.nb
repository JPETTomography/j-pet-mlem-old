(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     30070,        869]
NotebookOptionsPosition[     27633,        779]
NotebookOutlinePosition[     27971,        794]
CellTagsIndexPosition[     27928,        791]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"M", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "c"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "b"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.547260339867773*^9, 3.547260356316017*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "c"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", "b"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.547260358550729*^9, 3.547269633741008*^9, 
  3.547383571760472*^9, 3.547433292650336*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v", "=", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.547260365637895*^9, 3.547260383640473*^9}, {
  3.547260556470209*^9, 3.547260558435426*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", ",", "y"}], "}"}]], "Output",
 CellChangeTimes->{3.547260384742474*^9, 3.54726055937453*^9, 
  3.547269633919409*^9, 3.547383571922942*^9, 3.547433292798648*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"chi2", "=", 
  RowBox[{
   RowBox[{"1", "/", "2"}], "  ", 
   RowBox[{"v", ".", "M", ".", "v"}]}]}]], "Input",
 CellChangeTimes->{{3.547260386406372*^9, 3.547260413288644*^9}, {
  3.547260447761508*^9, 3.547260449249576*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"y", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "x"}], "+", 
       RowBox[{"b", " ", "y"}]}], ")"}]}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", " ", "x"}], "+", 
       RowBox[{"c", " ", "y"}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.54726041150214*^9, 3.547260413776327*^9}, 
   3.547260450532005*^9, 3.547260560506834*^9, 3.547269633927066*^9, 
   3.547383571932178*^9, 3.547433292820786*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cx", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"chi2", ",", "x"}], "]"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.547260451989441*^9, 3.547260487274597*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", " ", "x"}], "+", 
  RowBox[{"c", " ", "y"}]}]], "Output",
 CellChangeTimes->{{3.547260464185188*^9, 3.54726049023842*^9}, 
   3.547260564581656*^9, 3.547269633956921*^9, 3.547383571983197*^9, 
   3.547433292897251*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"chi2", "-", 
       RowBox[{"R", "^", "2"}]}], "\[Equal]", "0"}], ",", 
     RowBox[{"cx", "\[Equal]", "0"}]}], "}"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.547260468387595*^9, 3.547260535839787*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.547260496965618*^9, 3.547260537168719*^9}, 
   3.547260567222865*^9, 3.547269634011135*^9, 3.547383572149822*^9, 
   3.547433293093389*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"chi2", "/.", 
  RowBox[{"x", "\[Rule]", 
   RowBox[{
    RowBox[{"-", "c"}], " ", 
    RowBox[{"y", "/", "a"}]}]}]}]], "Input",
 CellChangeTimes->{{3.547260572413661*^9, 3.54726060495652*^9}, {
  3.547265802936157*^9, 3.54726582136586*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "y", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"b", " ", "y"}], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["c", "2"], " ", "y"}], "a"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.547383572206308*^9, 3.547433293150564*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "y", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"b", " ", "y"}], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["c", "2"], " ", "y"}], "a"]}], ")"}], "4"}]], "Input",
 CellChangeTimes->{{3.547382890568083*^9, 3.547382890636355*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", "y", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"b", " ", "y"}], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["c", "2"], " ", "y"}], "a"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.547383572214082*^9, 3.547433293158671*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.547260608331051*^9, 3.547260610905304*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   RowBox[{"b", "-", 
    FractionBox[
     SuperscriptBox["c", "2"], "a"]}], ")"}], " ", 
  SuperscriptBox["y", "2"]}]], "Output",
 CellChangeTimes->{3.547260611996012*^9, 3.547265823312314*^9, 
  3.547269634051499*^9, 3.547383572266875*^9, 3.547433293211693*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"%", "-", 
     RowBox[{"R", "^", "2"}]}], "\[Equal]", "0"}], ",", "y"}], "]"}]], "Input",\

 CellChangeTimes->{{3.547260622146965*^9, 3.547260630270233*^9}, {
  3.547265827407775*^9, 3.547265827726667*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"y", "\[Rule]", 
     RowBox[{"-", 
      FractionBox["R", 
       RowBox[{
        SqrtBox["2"], " ", 
        SqrtBox[
         RowBox[{"b", "-", 
          FractionBox[
           SuperscriptBox["c", "2"], "a"]}]]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", "\[Rule]", 
     FractionBox["R", 
      RowBox[{
       SqrtBox["2"], " ", 
       SqrtBox[
        RowBox[{"b", "-", 
         FractionBox[
          SuperscriptBox["c", "2"], "a"]}]]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.547265828492478*^9, 3.547269634092556*^9, 
  3.547383572320535*^9, 3.547433293274141*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cy", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"chi2", ",", "y"}], "]"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.547260707869538*^9, 3.547260710293489*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", " ", "x"}], "+", 
  RowBox[{"b", " ", "y"}]}]], "Output",
 CellChangeTimes->{3.547260711026577*^9, 3.547269634133269*^9, 
  3.547383572372532*^9, 3.547433293284086*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"chi2", "/.", 
  RowBox[{"y", "\[Rule]", 
   RowBox[{
    RowBox[{"-", "c"}], " ", 
    RowBox[{"x", "/", "b"}]}]}]}]], "Input",
 CellChangeTimes->{{3.54726073490999*^9, 3.547260762638325*^9}, {
  3.547265849511648*^9, 3.547265858662572*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"a", " ", "x"}], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["c", "2"], " ", "x"}], "b"]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.547260747748475*^9, 3.547260763246915*^9}, 
   3.547265859381841*^9, 3.54726963414093*^9, 3.547383572380504*^9, 
   3.547433293293727*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.547260749235469*^9, 3.547260751642061*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"a", "-", 
    FractionBox[
     SuperscriptBox["c", "2"], "b"]}], ")"}], " ", 
  SuperscriptBox["x", "2"]}]], "Output",
 CellChangeTimes->{{3.547260752434903*^9, 3.54726076394491*^9}, 
   3.547265860489138*^9, 3.547269634172116*^9, 3.547383572433286*^9, 
   3.54743329336648*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"%", "-", 
     RowBox[{"R", "^", "2"}]}], "\[Equal]", "0"}], ",", "x"}], "]"}]], "Input",\

 CellChangeTimes->{{3.547260770311404*^9, 3.547260770654957*^9}, {
  3.547265862392627*^9, 3.54726586267944*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SqrtBox["2"], " ", "R"}], 
       SqrtBox[
        RowBox[{"a", "-", 
         FractionBox[
          SuperscriptBox["c", "2"], "b"]}]]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     FractionBox[
      RowBox[{
       SqrtBox["2"], " ", "R"}], 
      SqrtBox[
       RowBox[{"a", "-", 
        FractionBox[
         SuperscriptBox["c", "2"], "b"]}]]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.547260771427185*^9, 3.547265863414091*^9, 
  3.54726963420488*^9, 3.547383572490705*^9, 3.547433293432719*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"bbEllipse", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], ",", "a_", ",", "b_", ",", "c_", ",", 
    "R_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xLeft", ",", "xRight", ",", "yDown", ",", "yUp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"yDown", "=", 
      RowBox[{"-", 
       FractionBox["R", 
        SqrtBox[
         RowBox[{"b", "-", 
          FractionBox[
           SuperscriptBox["c", "2"], "a"]}]]]}]}], ";", " ", 
     RowBox[{"yUp", "=", 
      FractionBox[
       RowBox[{" ", "R"}], 
       SqrtBox[
        RowBox[{"b", "-", 
         FractionBox[
          SuperscriptBox["c", "2"], "a"]}]]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xLeft", "=", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{" ", "R"}], 
        SqrtBox[
         RowBox[{"a", "-", 
          FractionBox[
           SuperscriptBox["c", "2"], "b"]}]]]}]}], ";", 
     RowBox[{"xRight", "=", 
      FractionBox[
       RowBox[{" ", "R"}], 
       SqrtBox[
        RowBox[{"a", "-", 
         FractionBox[
          SuperscriptBox["c", "2"], "b"]}]]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FaceForm", "[", "]"}], ",", 
       RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "+", "xLeft"}], ",", 
           RowBox[{"y", "+", "yDown"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "+", "xRight"}], ",", 
           RowBox[{"y", "+", "yUp"}]}], "}"}]}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.547264477367831*^9, 3.547264662399775*^9}, {
  3.547264721906769*^9, 3.54726474409605*^9}, {3.547264795314209*^9, 
  3.547264796090839*^9}, {3.547265878456181*^9, 3.547265977390591*^9}, {
  3.547383098869085*^9, 3.547383110554953*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "reconstructEllipse", "]"}]], "Input",
 CellChangeTimes->{{3.547261137628736*^9, 3.54726114413278*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"reconstructEllipse", "[", 
   RowBox[{"a_", ",", "b_", ",", "c_", ",", "R_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M", ",", "P", ",", "ev"}], "}"}], ",", 
     RowBox[{
      RowBox[{"M", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "c"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", "b"}], "}"}]}], "}"}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ev", ",", "P"}], "}"}], "=", 
       RowBox[{"Eigensystem", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"ev", ",", 
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"P", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "]"}]}], "}"}]}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"NumericQ", "[", "a", "]"}], "&&", 
    RowBox[{"NumericQ", "[", "b", "]"}], "&&", 
    RowBox[{"NumericQ", "[", "c", "]"}], " ", "&&", 
    RowBox[{"NumericQ", "[", "R", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.547260850294128*^9, 3.547260917505376*^9}, {
   3.547261025251587*^9, 3.547261032915228*^9}, {3.547261104091964*^9, 
   3.547261132908807*^9}, {3.547261182301614*^9, 3.547261217591041*^9}, {
   3.547261422703427*^9, 3.547261627515906*^9}, {3.547264805035314*^9, 
   3.547264820822689*^9}, {3.547266265557515*^9, 3.54726626583673*^9}, 
   3.547267054670328*^9, {3.547267142138764*^9, 3.547267173493817*^9}, {
   3.547267227059816*^9, 3.547267286040599*^9}, {3.547267364496655*^9, 
   3.547267378610987*^9}, {3.547383174307933*^9, 3.547383174604194*^9}, 
   3.547387915105782*^9, 3.547387970261015*^9, 3.547433645481873*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"P", "=", 
  RowBox[{"reconstructEllipse", "[", 
   RowBox[{"4", ",", "4", ",", "1", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.547260919639113*^9, 3.547261001152213*^9}, {
  3.547261156322461*^9, 3.547261157063836*^9}, {3.547261225321137*^9, 
  3.547261239120164*^9}, {3.547261448911626*^9, 3.547261450566779*^9}, {
  3.547261503736164*^9, 3.547261506743366*^9}, {3.547383127099665*^9, 
  3.547383130037463*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"5.`", ",", "3.`"}], "}"}], ",", 
   RowBox[{"-", "0.7853981633974483`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.547260939661577*^9, 3.547261002260333*^9}, {
   3.547261115957577*^9, 3.547261157465855*^9}, {3.547261192382058*^9, 
   3.547261239831865*^9}, {3.547261437325667*^9, 3.547261454890254*^9}, {
   3.547261489414813*^9, 3.547261507062851*^9}, 3.547261554006312*^9, 
   3.54726163368874*^9, {3.547266268541858*^9, 3.547266275188647*^9}, 
   3.54726737990982*^9, 3.547269634491048*^9, {3.547383123437916*^9, 
   3.547383131787815*^9}, 3.547383572566218*^9, 3.54743329453522*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ellipse", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}], ",", "theta_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"R", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", "theta", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"Sin", "[", "theta", "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sin", "[", "theta", "]"}], ",", 
           RowBox[{"Cos", "[", "theta", "]"}]}], "}"}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FaceForm", "[", "]"}], ",", 
       RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
       RowBox[{"Polygon", "[", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"R", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"a", " ", 
               RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", " ", 
              RowBox[{"b", " ", 
               RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "}"}]}], "+", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Phi]", ",", "0", ",", 
            RowBox[{"2", "Pi"}], ",", "0.05"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.547263709717924*^9, 3.547263977972721*^9}, {
  3.547264026387665*^9, 3.54726409682602*^9}, {3.547264183045294*^9, 
  3.547264327130493*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ellipse", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], ",", "a_", ",", "b_", ",", "c_", ",", 
    "R_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ev", ",", "theta"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ev", ",", "theta"}], "}"}], "=", 
      RowBox[{"reconstructEllipse", "[", " ", 
       RowBox[{"a", ",", " ", "b", ",", "c", ",", "R"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ellipse", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], ",", 
       RowBox[{"R", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"ev", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], ",", 
          RowBox[{"1", "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"ev", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "]"}]}]}], " ", "}"}]}], 
       ",", "theta"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.547264351890138*^9, 3.547264446547523*^9}, {
  3.547264981096579*^9, 3.547265025667832*^9}, {3.54726615625376*^9, 
  3.547266185648581*^9}, {3.547266311711161*^9, 3.547266312056673*^9}, {
  3.547266889788994*^9, 3.547266926893764*^9}, {3.547267457965449*^9, 
  3.54726745884069*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{"ellipse", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", "4", ",", "2", ",", "0", ",", "1"}],
    "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.547264448931956*^9, 3.547264462541479*^9}, {
  3.547265035347888*^9, 3.547265071388633*^9}, {3.547266933827092*^9, 
  3.547266938097532*^9}, {3.547267159540744*^9, 3.547267159674246*^9}}],

Cell[BoxData[
 GraphicsBox[
  {EdgeForm[Thickness[Large]], FaceForm[None], PolygonBox[CompressedData["
1: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
U9k3FQ==
    "]]}]], "Output",
 CellChangeTimes->{
  3.547264463273535*^9, {3.547265029314611*^9, 3.547265077375487*^9}, 
   3.547266187249831*^9, {3.547266286425555*^9, 3.547266314866081*^9}, {
   3.547266929119246*^9, 3.547266939485956*^9}, 3.547267025317527*^9, 
   3.547267058865988*^9, 3.547267161732664*^9, 3.547267263345145*^9, 
   3.547267382293527*^9, {3.5472674535997*^9, 3.547267461760657*^9}, 
   3.547269634564177*^9, {3.547383151798355*^9, 3.547383179811259*^9}, 
   3.547383572649759*^9, 3.54743329470704*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reconstructEllipse", "[", 
  RowBox[{"4", ",", "2", ",", "0", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.547266960039505*^9, 3.547266972525417*^9}, {
  3.547267111864019*^9, 3.547267112094043*^9}, {3.547267150815867*^9, 
  3.547267151119542*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4.`", ",", "2.`"}], "}"}], ",", "3.141592653589793`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.547266974494668*^9, 3.54726702636402*^9, 3.547267059864333*^9, 
   3.547267112842597*^9, {3.547267148127239*^9, 3.547267177489733*^9}, 
   3.547267264345871*^9, {3.547267383774612*^9, 3.54726739698561*^9}, 
   3.547269634590459*^9, 3.547383153421196*^9, 3.547383572668451*^9, 
   3.547433294779373*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ellipse", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", "10", ",", "5", ",", "1", ",", 
      "1"}], "]"}], ",", 
    RowBox[{"bbEllipse", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", "10", ",", "5", ",", "1", ",", 
      "1"}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.547264675440579*^9, 3.54726469301484*^9}, {
  3.547265085858168*^9, 3.547265118002197*^9}, {3.547265166812329*^9, 
  3.547265189920423*^9}, {3.547265985606424*^9, 3.547266020778907*^9}, {
  3.547266200997453*^9, 3.54726620558741*^9}, {3.547266322701663*^9, 
  3.547266378077142*^9}, {3.547266423598939*^9, 3.547266436517675*^9}, {
  3.547266494624429*^9, 3.547266497869955*^9}, {3.54726655356019*^9, 
  3.547266557286101*^9}, {3.547267496679451*^9, 3.547267507712626*^9}, {
  3.547267611872348*^9, 3.547267642332877*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {EdgeForm[Thickness[Large]], FaceForm[None], PolygonBox[CompressedData["
1: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
8T/VRi3R
     "]]}, 
   {EdgeForm[Thickness[Tiny]], FaceForm[None], 
    RectangleBox[
     NCache[{Rational[-1, 7] 5^Rational[1, 2], Rational[-1, 7] 
       10^Rational[1, 2]}, {-0.31943828249996997`, -0.45175395145262565`}], 
     NCache[{Rational[1, 7] 5^Rational[1, 2], Rational[1, 7] 
       10^Rational[1, 2]}, {0.31943828249996997`, 
      0.45175395145262565`}]]}}]], "Output",
 CellChangeTimes->{
  3.547264694671007*^9, {3.547265087243077*^9, 3.547265118987785*^9}, {
   3.54726517161055*^9, 3.547265190623106*^9}, {3.547265987456061*^9, 
   3.547266021347109*^9}, {3.547266190911862*^9, 3.547266206574135*^9}, {
   3.547266317771039*^9, 3.547266378776755*^9}, {3.547266426822724*^9, 
   3.547266437302242*^9}, 3.547266498598619*^9, 3.54726655802824*^9, {
   3.547267384922849*^9, 3.547267397742889*^9}, 3.547267465790319*^9, {
   3.54726750033364*^9, 3.54726750909884*^9}, {3.547267615632906*^9, 
   3.547267644717624*^9}, 3.54726963462409*^9, 3.547383154419573*^9, 
   3.547383188187857*^9, 3.547383572725139*^9, 3.547433294872095*^9, 
   3.547436637845113*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "ellipseBoundingBox", "]"}]], "Input",
 CellChangeTimes->{{3.580368756020515*^9, 3.580368760646131*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ellipseBoundingBox", "[", 
  RowBox[{"1", ",", "1", ",", "0", ",", "2", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.580368726953721*^9, 3.580368779652764*^9}, {
  3.580368819618858*^9, 3.580368819905813*^9}, {3.580368860271557*^9, 
  3.580368862154694*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.580368743449231*^9, 3.580368782119494*^9}, {
  3.580368820480219*^9, 3.580368862738548*^9}}]
}, Open  ]]
},
WindowSize->{740, 1000},
WindowMargins->{{Automatic, 273}, {Automatic, -8}},
FrontEndVersion->"8.0 for Linux x86 (32-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 264, 8, 30, "Input"],
Cell[846, 32, 282, 8, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1165, 45, 211, 5, 30, "Input"],
Cell[1379, 52, 205, 4, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1621, 61, 249, 6, 30, "Input"],
Cell[1873, 69, 569, 17, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2479, 91, 204, 5, 30, "Input"],
Cell[2686, 98, 257, 6, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2980, 109, 321, 9, 30, "Input"],
Cell[3304, 120, 207, 4, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3548, 129, 264, 7, 30, "Input"],
Cell[3815, 138, 294, 9, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4146, 152, 300, 9, 59, "Input"],
Cell[4449, 163, 273, 8, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4759, 176, 123, 2, 30, "Input"],
Cell[4885, 180, 314, 8, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5236, 193, 280, 8, 30, "Input"],
Cell[5519, 203, 670, 23, 76, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6226, 231, 204, 5, 30, "Input"],
Cell[6433, 238, 207, 5, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6677, 248, 265, 7, 30, "Input"],
Cell[6945, 257, 391, 11, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7373, 273, 123, 2, 30, "Input"],
Cell[7499, 277, 362, 10, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7898, 292, 279, 8, 30, "Input"],
Cell[8180, 302, 683, 23, 82, "Output"]
}, Open  ]],
Cell[8878, 328, 2007, 60, 267, "Input"],
Cell[10888, 390, 140, 2, 30, "Input"],
Cell[11031, 394, 1960, 48, 126, "Input"],
Cell[CellGroupData[{
Cell[13016, 446, 446, 8, 30, "Input"],
Cell[13465, 456, 658, 12, 30, "Output"]
}, Open  ]],
Cell[14138, 471, 1796, 49, 145, "Input"],
Cell[15937, 522, 1417, 38, 88, "Input"],
Cell[CellGroupData[{
Cell[17379, 564, 414, 9, 30, "Input"],
Cell[17796, 575, 3313, 56, 447, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21146, 636, 278, 5, 30, "Input"],
Cell[21427, 643, 473, 11, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21937, 659, 964, 21, 30, "Input"],
Cell[22904, 682, 3864, 66, 447, "Output"]
}, Open  ]],
Cell[26783, 751, 141, 2, 30, "Input"],
Cell[CellGroupData[{
Cell[26949, 757, 337, 7, 30, "Input"],
Cell[27289, 766, 328, 10, 30, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
