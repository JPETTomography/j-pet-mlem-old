(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      9767,        368]
NotebookOptionsPosition[      8558,        319]
NotebookOutlinePosition[      8914,        335]
CellTagsIndexPosition[      8871,        332]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"a", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"y", "+", "dy", "-", "R"}], ")"}]}], "*", 
     RowBox[{"sec", "^", "2"}]}], ",", "\[IndentingNewLine]", "    ", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"y", "+", "dy", "+", "R"}], ")"}]}], "*", 
     RowBox[{"sec", "^", "2"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"(", 
      RowBox[{"dy", "+", "y"}], ")"}], " ", "*", "sec", "*", "tan"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.655462280139044*^9, 3.655462362930482*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["sec", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "dy"}], "+", "R", "-", "y"}], ")"}]}], ",", 
   RowBox[{
    SuperscriptBox["sec", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "dy"}], "-", "R", "-", "y"}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "sec", " ", "tan", " ", 
    RowBox[{"(", 
     RowBox[{"dy", "+", "y"}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.655462363485425*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"b", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"dx", "-", " ", 
     RowBox[{"dy", "*", "tan"}]}], ",", " ", 
    RowBox[{"dx", "-", 
     RowBox[{"dy", "*", "tan"}]}], ",", " ", 
    RowBox[{
     RowBox[{"-", "2"}], " ", "dy", " ", "*", "sec"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.655462384940174*^9, 3.655462446296529*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dx", "-", 
    RowBox[{"dy", " ", "tan"}]}], ",", 
   RowBox[{"dx", "-", 
    RowBox[{"dy", " ", "tan"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "dy", " ", "sec"}]}], "}"}]], "Output",
 CellChangeTimes->{3.655462447098721*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"invCov", "=", 
  RowBox[{"Inverse", "[", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dz", ",", "dz", ",", "dl"}], "}"}], "^", "2"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6554624603631477`*^9, 3.6554624842893476`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["dz", "2"]], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", 
      SuperscriptBox["dz", "2"]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     FractionBox["1", 
      SuperscriptBox["dl", "2"]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.655462485330277*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"aa", "=", 
  RowBox[{"a", ".", "invCov", ".", "a"}]}]], "Input",
 CellChangeTimes->{{3.655462488435465*^9, 3.655462501018794*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["sec", "4"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "dy"}], "-", "R", "-", "y"}], ")"}], "2"]}], 
   SuperscriptBox["dz", "2"]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["sec", "4"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "dy"}], "+", "R", "-", "y"}], ")"}], "2"]}], 
   SuperscriptBox["dz", "2"]], "+", 
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox["sec", "2"], " ", 
    SuperscriptBox["tan", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"dy", "+", "y"}], ")"}], "2"]}], 
   SuperscriptBox["dl", "2"]]}]], "Output",
 CellChangeTimes->{{3.655462495506109*^9, 3.6554625016594353`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bb", "=", " ", 
  RowBox[{"b", ".", "invCov", ".", "b"}]}]], "Input",
 CellChangeTimes->{{3.655462502566855*^9, 3.655462506520905*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox["dy", "2"], " ", 
    SuperscriptBox["sec", "2"]}], 
   SuperscriptBox["dl", "2"]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"dx", "-", 
       RowBox[{"dy", " ", "tan"}]}], ")"}], "2"]}], 
   SuperscriptBox["dz", "2"]]}]], "Output",
 CellChangeTimes->{3.6554625083532867`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bb", " ", "//", "Expand"}]], "Input",
 CellChangeTimes->{{3.655462613926375*^9, 3.655462621050274*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["dx", "2"]}], 
   SuperscriptBox["dz", "2"]], "+", 
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox["dy", "2"], " ", 
    SuperscriptBox["sec", "2"]}], 
   SuperscriptBox["dl", "2"]], "-", 
  FractionBox[
   RowBox[{"4", " ", "dx", " ", "dy", " ", "tan"}], 
   SuperscriptBox["dz", "2"]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["dy", "2"], " ", 
    SuperscriptBox["tan", "2"]}], 
   SuperscriptBox["dz", "2"]]}]], "Output",
 CellChangeTimes->{3.655462622130368*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{"dx", ",", "dy"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.655462625663762*^9, 3.655462632762898*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["dx", "2"]}], 
   SuperscriptBox["dz", "2"]], "-", 
  FractionBox[
   RowBox[{"4", " ", "dx", " ", "dy", " ", "tan"}], 
   SuperscriptBox["dz", "2"]], "+", 
  RowBox[{
   SuperscriptBox["dy", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"4", " ", 
       SuperscriptBox["sec", "2"]}], 
      SuperscriptBox["dl", "2"]], "+", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["tan", "2"]}], 
      SuperscriptBox["dz", "2"]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.655462633527011*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", "/", 
      RowBox[{"dz", "^", "2"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{"tan", "/", 
       RowBox[{"dz", "^", "2"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{"tan", "/", 
       RowBox[{"dz", "^", "2"}]}]}], ",", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        RowBox[{
         RowBox[{"sec", "^", "2"}], "/", 
         RowBox[{"dl", "^", "2"}]}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         RowBox[{"tan", "^", "2"}], "/", 
         RowBox[{"dz", "^", "2"}]}]}]}], ")"}]}], "}"}]}], "}"}]], "Input",
 CellChangeTimes->{
  3.6554626449906282`*^9, {3.655462682365429*^9, 3.655462739900745*^9}, {
   3.655463276166498*^9, 3.6554632801152554`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["2", 
      SuperscriptBox["dz", "2"]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", "tan"}], 
       SuperscriptBox["dz", "2"]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", "tan"}], 
       SuperscriptBox["dz", "2"]]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"4", " ", 
        SuperscriptBox["sec", "2"]}], 
       SuperscriptBox["dl", "2"]], "+", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["tan", "2"]}], 
       SuperscriptBox["dz", "2"]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6554633128496647`*^9, 3.6554633320562153`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Det", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.655462763005453*^9, 3.655462766072838*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"8", " ", 
   SuperscriptBox["sec", "2"]}], 
  RowBox[{
   SuperscriptBox["dl", "2"], " ", 
   SuperscriptBox["dz", "2"]}]]], "Output",
 CellChangeTimes->{
  3.655462767212203*^9, {3.655463288234611*^9, 3.655463337188586*^9}}]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{Automatic, 582}, {Automatic, 221}},
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 29, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 639, 19, 63, "Input"],
Cell[1222, 43, 517, 17, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1776, 65, 366, 10, 28, "Input"],
Cell[2145, 77, 288, 9, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2470, 91, 295, 8, 28, "Input"],
Cell[2768, 101, 461, 15, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3266, 121, 154, 3, 28, "Input"],
Cell[3423, 126, 779, 26, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4239, 157, 159, 3, 28, "Input"],
Cell[4401, 162, 412, 14, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4850, 181, 127, 2, 28, "Input"],
Cell[4980, 185, 577, 19, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5594, 209, 200, 5, 28, "Input"],
Cell[5797, 216, 615, 21, 88, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6449, 242, 902, 29, 46, "Input"],
Cell[7354, 273, 762, 26, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8153, 304, 122, 2, 28, "Input"],
Cell[8278, 308, 264, 8, 51, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
